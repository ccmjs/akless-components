(()=>{const component={name:"menu",version:[3,0,2],ccm:"https://ccmjs.github.io/ccm/versions/ccm-26.2.1.js",config:{css:["ccm.load","https://ccmjs.github.io/akless-components/menu/resources/default.css"],data:{store:["ccm.store"]},helper:["ccm.load","https://ccmjs.github.io/akless-components/modules/versions/helper-7.1.0.mjs"],html:["ccm.load","https://ccmjs.github.io/akless-components/menu/resources/default.html"]},Instance:function(){let $,app;this.init=(async()=>{if(!this.inner)return;const entries=[];[...this.inner.children].forEach(child=>{if(child.tagName&&child.tagName==="ENTRY")entries.push({title:child.getAttribute("title"),content:child.innerHTML})});this.data={entries:entries}});this.ready=(async()=>{$=Object.assign({},this.ccm.helper,this.helper);$.use(this.ccm);this.logger&&this.logger.log("ready",$.privatize(this,true))});this.start=(async()=>{app=await $.dataset(this.data);app.entries=app.entries.map(entry=>typeof entry==="string"?{title:entry}:entry);this.logger&&this.logger.log("start",this.getValue());$.setContent(this.element,$.html(this.html.main,{onprev:this.prev,onnext:this.next}));this.keyboard_control&&document.addEventListener("keydown",event=>{if(event.key==="ArrowRight"||event.key==="PageDown")this.next();else if(event.key==="ArrowLeft"||event.key==="PageUp")this.prev()});let x_start=null;if(this.touch_control){this.element.addEventListener("touchstart",event=>{const getTouches=event=>event.touches||event.originalEvent.touches;const firstTouch=getTouches(event)[0];x_start=firstTouch.clientX});this.element.addEventListener("touchmove",event=>{if(!x_start||!event)return;this[x_start-event.touches[0].clientX>0?"prev":"next"]();x_start=null})}if(this.lang){$.append(this.element.querySelector("#top"),this.lang.root);this.lang.start()}await renderEntries(this.selected);this.routing&&this.routing.define({entry:id=>this.select(parseInt(id)||id)})});this.disable=((entry_id,disable)=>{getEntry(entry_id).disabled=disable;renderEntry(entry_id)});this.getEntryData=(entry_id=>$.clone(getEntry(entry_id)));this.getEntryElem=(entry_id=>typeof entry_id==="string"?this.element.querySelector("#entry-"+entry_id):this.element.querySelectorAll(".entry")[entry_id-1]);this.getSelectedEntry=(()=>{const entry_elem=this.element.querySelector(".entry.active");return entry_elem&&(parseInt(entry_elem.dataset.id)||entry_elem.dataset.id)});this.getValue=(()=>$.clone(app));this.next=(()=>{const entry_elem=this.getEntryElem(this.getSelectedEntry());entry_elem&&(entry_elem.nextElementSibling||this.element.querySelector("#entries").firstElementChild).click()});this.prev=(()=>{const entry_elem=this.getEntryElem(this.getSelectedEntry());entry_elem&&(entry_elem.previousElementSibling||this.element.querySelector("#entries").lastElementChild).click()});this.refresh=(async(dataset=app)=>renderEntries(app=dataset));this.select=(async(entry_id,noclick)=>{const entry_elem=this.getEntryElem(entry_id);if(!entry_elem)return;const is_selected=entry_elem&&entry_elem.classList.contains("selected");const selected_entry=this.element.querySelector(".entry.selected");if(selected_entry){selected_entry.classList.remove("selected","active");selected_entry.firstChild.classList.remove("active")}if(!entry_id)return;const entry_data=getEntry(entry_id);this.routing&&this.routing.set("entry-"+entry_data.id);if(!is_selected||!this.deselectable){entry_elem.classList.add("selected","active");entry_elem.firstChild.classList.add("active")}const title_elem=this.element.querySelector("#title");if(title_elem){if(this.lang)title_elem.dataset[this.lang.component.name]=entry_data.title;else $.setContent(title_elem,$.html(entry_data.title));title_elem.classList.remove("fading");void title_elem.offsetWidth;title_elem.classList.add("fading")}this.lang&&this.lang.translate();if(noclick)return;this.deselectable&&$.setContent(this.element.querySelector("#content"),"");if(is_selected&&!this.trigger_selected)return;await renderContent(entry_id);this.logger&&this.logger.log("click",{id:entry_id,entry:$.clone(entry_data)});this.onchange&&this.onchange({id:this.getSelectedEntry(),entry:$.clone(entry_data),element:entry_elem,instance:this})});const getEntry=entry_id=>app.entries[typeof entry_id==="string"?[...this.element.querySelector("#entries").children].indexOf(this.getEntryElem(entry_id)):entry_id-1];const renderEntries=async selected=>{app.entries&&app.entries.forEach((entry,i)=>renderEntry(i+1));if(selected&&(!this.routing||!this.routing.get()))await this.select(selected);this.lang&&this.lang.translate()};const renderEntry=entry_id=>{const entry_data=getEntry(entry_id);if(!entry_data)return;if(!entry_data.id)entry_data.id=entry_id;const new_entry=$.html(this.html.entry,{id:entry_data.id,click:onClick});const title_elem=new_entry.querySelector(".title");if(title_elem)if(this.lang)title_elem.dataset[this.lang.component.name]=entry_data.title;else $.setContent(title_elem,$.html(entry_data.title));if(entry_data.disabled){new_entry.disabled=true;new_entry.classList.add("disabled");new_entry.removeEventListener("click",onClick)}const old_entry=this.getEntryElem(entry_id);if(old_entry)$.replace(old_entry,new_entry);else $.append(this.element.querySelector("#entries"),new_entry)};const onClick=async event=>{const id=event.target.closest(".entry").dataset.id;await this.select(parseInt(id)||id)};const renderContent=async entry_id=>{const entry_data=getEntry(entry_id);entry_data.content=await $.solveDependency(entry_data.content);if(!entry_data.content)return;const content_elem=this.element.querySelector("#content");if($.isComponent(entry_data.content))await entry_data.content.start({parent:this,root:content_elem});else if(this.content)await this.content.start({root:content_elem,inner:entry_data.content});else $.setContent(content_elem,$.html(entry_data.content));content_elem.classList.remove("fading");void content_elem.offsetWidth;content_elem.classList.add("fading")}}};let b="ccm."+component.name+(component.version?"-"+component.version.join("."):"")+".js";if(window.ccm&&null===window.ccm.files[b])return window.ccm.files[b]=component;(b=window.ccm&&window.ccm.components[component.name])&&b.ccm&&(component.ccm=b.ccm);"string"===typeof component.ccm&&(component.ccm={url:component.ccm});let c=(component.ccm.url.match(/(0|[1-9]\d*)\.(0|[1-9]\d*)\.(0|[1-9]\d*)/)||[""])[0];if(window.ccm&&window.ccm[c])window.ccm[c].component(component);else{var a=document.createElement("script");document.head.appendChild(a);component.ccm.integrity&&a.setAttribute("integrity",component.ccm.integrity);component.ccm.crossorigin&&a.setAttribute("crossorigin",component.ccm.crossorigin);a.onload=function(){(c="latest"?window.ccm:window.ccm[c]).component(component);document.head.removeChild(a)};a.src=component.ccm.url}})();