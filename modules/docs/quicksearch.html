<html>
<head>
</head>
<body style="background: transparent;">
    <script src="scripts/docstrap.lib.js"></script>
    <script src="scripts/lunr.min.js"></script>
    <script src="scripts/fulltext-search.js"></script>

    <script type="text/x-docstrap-searchdb">
    {"helper.mjs.html":{"id":"helper.mjs.html","title":"Source: helper.mjs","body":" helper.mjs Namespaces ModuleHelperModuleHelper.ActionDataModuleHelper.AsynchronousProgrammingModuleHelper.BackwardsCompatibilityModuleHelper.CheckerModuleHelper.DataHandlingModuleHelper.DataWorkflowModuleHelper.DomManipulationModuleHelper.HandoverAppModuleHelper.InputElementsModuleHelper.OthersModuleHelper.Security Source: helper.mjs /** * @overview * ES6 module that exports useful help functions for &lt;i&gt;ccmjs&lt;/i&gt; component developers. * @author Andr√© Kless &lt;andre.kless@web.de&gt; 2019-2020 * @license The MIT License (MIT) * @version latest (6.0.0) * @changes * version 6.0.0 (04.10.2020): * - added use(ccm):void * - removed parameter 'ccm' in help functions * - added xml2json(xml):json * - added render(TemplateResult,element):void * - updated arrToObj(arr):obj * - bug fix for appURL(component,config,url):string -&gt; component and config is now URL encoded * - updated privatize(instance,keys):void -&gt; added 'inner' to not logged ccmjs-specific properties * - code refactoring -&gt; export of constants with arrow functions instead of functions * - updated doc comments -&gt; consider upcoming &lt;i&gt;ccmjs&lt;/i&gt; version 26.0.0 * (for older version changes see helper-5.1.0.mjs) */ /** * (the namespaces are only used for categorization) * @namespace ModuleHelper */ /*--------------------------------------------- Backwards Compatibility ----------------------------------------------*/ /** * help functions for backwards compatibility * @namespace ModuleHelper.BackwardsCompatibility */ /** * used &lt;i&gt;ccmjs&lt;/i&gt; version by the help functions of this module (default: latest version that is loaded within the webpage so far) * @type {Object} * @private */ let ccm = window.ccm; /** * sets the _ccmjs_ version used by the help functions of this module * @function * @param {Object} version - &lt;i&gt;ccmjs&lt;/i&gt; version * @memberOf ModuleHelper.BackwardsCompatibility */ export const use = version =&gt; ccm = version; /*--------------------------------------------------- Action Data ----------------------------------------------------*/ /** * help functions for handling action data (predefined function calls) * @namespace ModuleHelper.ActionData */ /** * executes action data * @function * @async * @param {Array} action - action data * @param {Object} [context] - context for &lt;code&gt;this&lt;/code&gt; * @returns {Promise&lt;*&gt;} return value of executed action data * @example action( [ functionName, 'param1', 'param2' ] ) * @example action( [ 'functionName', 'param1', 'param2' ] ) * @example action( [ 'this.functionName', 'param1', 'param2' ], context ) * @example action( [ function () { console.log( this ); } ], context ) * @example action( [ 'my.namespace.functionName', 'param1', 'param2' ] ) * @example action( [ [ 'ccm.load', 'moduleURL#functionName' ], 'param1', 'param2' ] ) * @example action( [ functionName ] ) // without parameters * @example action( functionName ) // without array * @memberOf ModuleHelper.ActionData */ export const action = async ( action, context ) =&gt; { // action is no array? =&gt; convert to array if ( !Array.isArray( action ) ) action = [ action ]; // support import of an external function action[ 0 ] = await ccm.helper.solveDependency( action[ 0 ] ); // execute action data if ( typeof action[ 0 ] === 'function' ) return action[ 0 ].apply( context, action.slice( 1 ) ); else return executeByName( action[ 0 ], action.slice( 1 ), context ); }; /** * performs a function by function name * @function * @param {string} name - function name * @param {Array} [args] - function arguments * @param {Object} [context] - context for &lt;code&gt;this&lt;/code&gt; * @returns {*} return value of performed function * @example action( [ 'functionName', 'param1', 'param2' ] ) * @example action( [ 'this.functionName', 'param1', 'param2' ], context ) * @example action( [ 'my.namespace.functionName', 'param1', 'param2' ] ) * @memberOf ModuleHelper.ActionData */ export const executeByName = ( name, args, context ) =&gt; { const namespaces = name.split( '.' ); let flag; if ( namespaces[ 0 ] === 'this' ) flag = !!namespaces.shift(); let namespace = flag ? context : window; name = namespaces.pop(); namespaces.forEach( value =&gt; namespace = namespace[ value ] ); return namespace[ name ].apply( context, args ); }; /*--------------------------------------------- Asynchronous Programming ---------------------------------------------*/ /** * help functions for handling asynchronous programming * @namespace ModuleHelper.AsynchronousProgramming */ /** * workaround for an asynchronous foreach * @function * @async * @param {Array} array - array to be iterated * @param {Function} callback - asynchronous function that is called for each array value * @returns {Promise&lt;void&gt;} * @example * const waiting_times = [ 100, 200, 300 ]; * await asyncForEach( waiting_times, async ( value, i, array ) =&gt; { * await sleep( value ); * console.log( value, i, array ); * } ); * @memberOf ModuleHelper.AsynchronousProgramming */ export const asyncForEach = async ( array, callback ) =&gt; { for ( let i = 0; i &lt; array.length; i++ ) await callback( array[ i ], i, array ); }; /** * sleep for a given number of milliseconds * @function * @async * @param {number} time - sleep time in milliseconds * @returns {Promise&lt;void&gt;} * @example await sleep( 3000 ); * @example sleep( 3000 ).then( () =&gt; {...} ) ); * @memberOf ModuleHelper.AsynchronousProgramming */ export const sleep = time =&gt; new Promise( resolve =&gt; setTimeout( resolve, time ) ); /*----------------------------------------------------- Checker ------------------------------------------------------*/ /** * help functions for condition checks * @namespace ModuleHelper.Checker */ /** * checks if an instance has DOM contact * @function * @param {Object} instance - &lt;i&gt;ccmjs&lt;/i&gt;-based instance * @returns {boolean} * @example * // &lt;body&gt;&lt;div id=\"app\"&gt;&lt;/div&gt;&lt;/body&gt; * const instance = await ccm.instance( component, { root: document.querySelector( '#app' ) } ); * console.log( hasDomContact( instance ) ) ); // =&gt; true * @example * const instance = await ccm.instance( component, { root: document.createElement( 'div' ) } ); * console.log( hasDomContact( instance ) ) ); // =&gt; false * @example * // &lt;body&gt;&lt;div id=\"app\"&gt;&lt;/div&gt;&lt;/body&gt; * const parent = await ccm.instance( component, { root: document.querySelector( '#app' ) } ); * const instance = await ccm.instance( component, { parent: parent } ); * parent.element.appendChild( instance.root ); * console.log( hasDomContact( instance ) ) ); // =&gt; true * @example * // &lt;body&gt;&lt;div id=\"app\"&gt;&lt;/div&gt;&lt;/body&gt; * const parent = await ccm.instance( component, { root: document.querySelector( '#app' ) } ); * const instance = await ccm.instance( component, { parent: parent } ); * console.log( hasDomContact( instance ) ) ); // =&gt; false * @memberOf ModuleHelper.Checker */ export const hasDomContact = instance =&gt; document.contains( ccm.context.root( instance ).root ) &amp;&amp; ( hasParentContact( instance ) || !instance.parent ); /** * checks if an instance has parent element contact * @function * @param {Object} instance - &lt;i&gt;ccmjs&lt;/i&gt;-based instance * @returns {boolean} * @example * const parent = await ccm.instance( component ); * const instance = await ccm.instance( component, { parent: parent } ); * parent.element.appendChild( instance.root ); * console.log( hasParentContact( instance ) ) ); // =&gt; true * @example * const parent = await ccm.instance( component ); * const instance = await ccm.instance( component, { parent: parent } ); * console.log( hasParentContact( instance ) ) ); // =&gt; false * @memberOf ModuleHelper.Checker */ export const hasParentContact = instance =&gt; instance.parent &amp;&amp; instance.parent.element.contains( instance.root ); /** * checks if current web browser is Firefox * @function * @returns {boolean} * @memberOf ModuleHelper.Checker */ export const isFirefox = () =&gt; navigator.userAgent.search( 'Firefox' ) &gt; -1; /** * checks if current web browser is Google Chrome * @function * @returns {boolean} * @memberOf ModuleHelper.Checker */ export const isGoogleChrome = () =&gt; /Chrome/.test( navigator.userAgent ) &amp;&amp; /Google Inc/.test( navigator.vendor ); /** * checks if current web browser is Safari * @function * @returns {boolean} * @memberOf ModuleHelper.Checker */ export const isSafari = () =&gt; /^((?!chrome|android).)*safari/i.test( navigator.userAgent ); /*-------------------------------------------------- Data Handling ---------------------------------------------------*/ /** * help functions for data handling * @namespace ModuleHelper.DataHandling */ /** * converts an array of strings or numbers to an object of booleans * @function * @param {string[]|number[]} arr * @returns {Object.&lt;string,boolean&gt;} * @example console.log( arrToObj( [ 'foo', 'bar' ] ) ); // =&gt; { foo: true, bar: true } * @example console.log( arrToObj( [ 1, 2 ] ) ); // =&gt; { 1: true, 2: true } * @memberOf ModuleHelper.DataHandling */ export const arrToObj = arr =&gt; { if ( !Array.isArray( arr ) ) return null; const result = {}; arr.forEach( value =&gt; result[ value ] = true ); return result; }; /** * cleans an object/array from falsy values * @function * @param {Object|Array} obj * @param {boolean} [deep] - deep clean (recursive) * @returns {Object|Array} cleaned object/array * @example cleanObject( [ 'foo', false, 0, '', null, undefined, [], {} ] ) // =&gt; [ 'foo', [], {} ] * @memberOf ModuleHelper.DataHandling */ export const cleanObject = ( obj, deep ) =&gt; { if ( Array.isArray( obj ) ) { for ( let i = obj.length - 1; i &gt;= 0; i-- ) if ( !obj[ i ] ) obj.splice( i, 1 ); else if ( deep &amp;&amp; typeof obj[ i ] === 'object' &amp;&amp; !ccm.helper.isSpecialObject( obj[ i ] ) ) cleanObject( obj[ i ] ); } else for ( const key in obj ) if ( obj.hasOwnProperty( key ) ) if ( !obj[ key ] ) delete obj[ key ]; else if ( deep &amp;&amp; typeof obj[ key ] === 'object' &amp;&amp; !ccm.helper.isSpecialObject( obj[ key ] ) ) cleanObject( obj[ key ] ); return obj; }; /** * @summary decodes with encodeJSON() encoded JSON * @description * All &lt;code&gt;%'%&lt;/code&gt; are replaced with &lt;code&gt;\"&lt;/code&gt;.&lt;br&gt; * Returns passed parameter if decoding fails. * @function * @param {string} str - encoded JSON * @returns {Object|Array|string} decoded JSON * @example decodeJSON( \"{%'%log%'%:true,%'%restart%'%:true}\" ) // =&gt; { log: true, restart: true } * @example decodeJSON( \"[%'%ccm.instance%'%,%'%./ccm.user.js%'%]\" ) // =&gt; [ \"ccm.instance\", \"./ccm.user.js\" ] * @memberOf ModuleHelper.DataHandling */ export const decodeJSON = str =&gt; { if ( typeof str !== 'string' || !ccm.helper.regex( 'json' ).test( str ) ) return null; return ccm.helper.parse( str.replace( /%'%/g, '\"' ) ); }; /** * @summary encodes JSON as string so that it can be set as value for input elements * @description * All &lt;code&gt;\"&lt;/code&gt; are replaced with &lt;code&gt;%'%&lt;/code&gt;.&lt;br&gt; * Returns passed parameter if encoding fails. * @function * @param {Object|Array} json - JSON * @returns {string} encoded JSON * @example encodeJSON( { log: true, restart: true } ) // =&gt; \"{%'%log%'%:true,%'%restart%'%:true}\" * @example encodeJSON( [ 'ccm.instance', './ccm.user.js' ] ) // =&gt; \"[%'%ccm.instance%'%,%'%./ccm.user.js%'%]\" * @memberOf ModuleHelper.DataHandling */ export const encodeJSON = json =&gt; { if ( typeof json !== 'object' ) return ''; return ccm.helper.stringify( json ).replace( /\"/g, \"%'%\" ); }; /** * escapes HTML characters of a string value * @function * @param {string} value - string value * @returns {string} * @example escapeHTML( 'Hello &lt;b&gt;World&lt;/b&gt;!' ) // =&gt; 'Hello &amp;lt;b&amp;gt;World&amp;lt;/b&amp;gt;!' * @memberOf ModuleHelper.DataHandling */ export const escapeHTML = value =&gt; { const text = document.createTextNode( value ); const div = document.createElement( 'div' ); div.appendChild( text ); return div.innerHTML; }; /** * filters a specific subset of complex data * @function * @param {Object} data - complex data * @param {Object} [mask] - defines specific subset * @returns {Object} subset of complex data * @example filterData( { a: 'x', b: 'y', c: 'c' }, { a: true, b: true } ) // =&gt; { a: 'x', b: 'y' } * @example filterData( { a: [ 1, 2, 3 ] }, { 'a.1': true, 'a.2': true } ) // =&gt; { a: [ null, 2, 3 ] } * @example filterData( { a: [ 1, 2, 3 ] }, { a: true, 'a.2': false } ) // =&gt; { a: [ 1, 2, '' ] } * @example filterData( { a: { x: 1, y: 2, z: 3 } }, { 'a.x': true, 'a.y': true } ) // =&gt; { a: { x: 1, y: 2 } } * @memberOf ModuleHelper.DataHandling */ export const filterData = ( data, mask ) =&gt; { if ( !mask ) return ccm.helper.clone( data ); data = ccm.helper.toDotNotation( data, true ); mask = ccm.helper.toDotNotation( mask ); const result = {}; for ( const key in mask ) ccm.helper.deepValue( result, key, mask[ key ] ? data[ key ] : '' ); return result; }; /** * filters properties from an object * @function * @param {Object} obj - object * @param {...string} [keys] - properties * @return {Object} object that contains only filtered properties * @example filterProperties( { a: 'x', b: 'y', c: 'z' }, 'a', 'b' ) // =&gt; { a: 'x', b: 'y' } * @memberOf ModuleHelper.DataHandling */ export const filterProperties = ( obj, ...keys ) =&gt; { const result = {}; keys.forEach( key =&gt; { if ( obj[ key ] !== undefined ) result[ key ] = obj[ key ]; } ); return result; }; /** * renames the property name of an object * @function * @param {Object} obj - the object that contains the property * @param {string} before - old property name * @param {string} after - new property name * @example * const obj = { foo: 4711 }; * renameProperty( obj, 'foo', 'bar' ); * console.log( obj ); // =&gt; { \"bar\": 4711 } * @memberOf ModuleHelper.DataHandling */ export const renameProperty = ( obj, before, after ) =&gt; { obj[ after ] = obj[ before ]; delete obj[ before ]; if ( obj[ after ] === undefined ) delete obj[ after ]; }; /** * shuffles an array in place with the Fisher-Yates algorithm * @see https://stackoverflow.com/a/6274381 * @function * @param {Array} array * @example * const array = [ 1, 2, 3 ]; * shuffleArray( array ); * console.log( array ); * @memberOf ModuleHelper.DataHandling */ export const shuffleArray = array =&gt; { for ( let i = array.length - 1; i &gt; 0; i-- ) { const j = Math.floor( Math.random() * ( i + 1 ) ); [ array[ i ], array[ j ] ] = [ array[ j ], array[ i ] ]; } }; /** * unescapes HTML characters of a string value * @function * @param {string} value - string value * @returns {string} * @example escapeHTML( 'Hello &amp;lt;b&amp;gt;World&amp;lt;/b&amp;gt;!' ) // =&gt; 'Hello &lt;b&gt;World&lt;/b&gt;!' * @memberOf ModuleHelper.DataHandling */ export const unescapeHTML = value =&gt; { const element = document.createElement( 'div' ); return value.replace( /\\&amp;[#0-9a-z]+;/gi, str =&gt; { element.innerHTML = str; return element.innerText; } ); }; /** * converts a XML document to JSON, attributes of XML elements are ignored * @function * @param {XMLDocument} xml * @returns {Object} JSON * @memberOf ModuleHelper.DataHandling */ export const xml2json = xml =&gt; { const json = {}; recursive( json, xml.firstElementChild ); return json; function recursive( obj, elem ) { if ( elem.childElementCount ) { obj[ elem.tagName ] = {}; Array.from( elem.children ).forEach( child =&gt; recursive( obj[ elem.tagName ], child ) ); } else obj[ elem.tagName ] = elem.innerHTML; } }; /*-------------------------------------------------- Data Workflow ---------------------------------------------------*/ /** * help functions for data workflow handling * @namespace ModuleHelper.DataWorkflow */ /** * @summary gets a dataset from a datastore via given settings * @description * The original settings given are not changed (they are cloned).&lt;br&gt; * If the settings do not contain a dataset key, a unique key is generated.&lt;br&gt; * If the dataset does not exist in the datastore, an empty dataset is returned. This dataset is not newly created in the datastore and is only returned locally.&lt;br&gt; * Instead of the settings, a dataset can be given directly. This dataset is then returned as result.&lt;br&gt; * If the dataset key is specified in the settings directly as the dataset, this dataset is returned as the result.&lt;br&gt; * An instance for user authentication that can be reached from the datastore is automatically detected. * @function * @async * @param {Object} [settings={}] - contains the required data to determine the dataset (or is directly the dataset) * @param {Object} settings.store - the datastore that contains the dataset * @param {*} [settings.key] - the key of the dataset in the datastore (or initial dataset) * @param {boolean} [settings.login] - The user must log in if he is not already logged in to receive the dataset (only if an instance for user authentication could be determined automatically). * @param {boolean} [settings.user] - The dataset key given in the settings is expanded to a user-specific key: &lt;code&gt;[ dataset_key, user_key ]&lt;/code&gt; (only if user is detected and logged in) * @param {Object} [settings.permissions] - If the dataset does not exist, the empty dataset then returned will contain these permission settings. * @param {Function} [settings.convert] - With this function, the data contained in the result dataset can be adjusted. * @returns {Promise&lt;Object&gt;} * @throws {Error} if user must log in and login is canceled * @example * // load dataset by datastore and key * const dataset = await dataset( { store: datastore, key: dataset_key } ); * console.log( dataset ); // =&gt; { key: dataset_key, ... } * @example * // passed dataset is directly returned as the result * const dataset = await dataset( { key: dataset_key, ... } ); * console.log( dataset ); // =&gt; { key: dataset_key, ... } * @example * // passed dataset as key is directly returned as the result * const dataset = await dataset( { store: datastore, key: { key: dataset_key, ... } } ); * console.log( dataset ); // =&gt; { key: dataset_key, ... } * @example * // load of an user-specific dataset * const dataset = await dataset( { * store: datastore, * key: dataset_key, * login: true, // user must log in if not already logged in * user: true // dataset key and user key will be combined * } ); * console.log( dataset ); // =&gt; { key: [ dataset_key, user_key ], ... } * @example * // get new empty dataset with generated key that contains only given permission settings * const dataset = await dataset( { * store: datastore, * permissions: { creator: 'john', realm: 'guest', access: 'creator' } * } ); * console.log( dataset ); // =&gt; { key: generated_key, _: { creator: 'john', realm: 'guest', access: 'creator' } } * @example * // adaptation of the data structure of the loaded dataset using a convert function * const dataset = await dataset( { * store: datastore, * key: dataset_key, * convert: dataset =&gt; { dataset.lang = dataset.lang.toUpperCase(); return dataset; } * } ); * console.log( dataset ); // =&gt; { key: dataset_key, lang: 'EN', ... } * @memberOf ModuleHelper.DataWorkflow */ export const dataset = async ( settings = {} ) =&gt; { // no manipulation of original passed parameter (avoids unwanted side effects) settings = ccm.helper.clone( settings ); // settings are dataset directly? =&gt; dataset is result if ( !ccm.helper.isDatastore( settings.store ) ) return settings; // no dataset key? =&gt; generate a unique key if ( !settings.key ) settings.key = ccm.helper.generateKey(); // key is initial data? =&gt; take it as result if ( ccm.helper.isDataset( settings.key ) ) return settings.convert ? await settings.convert( settings.key ) : settings.key; /** * nearest user instance in &lt;i&gt;ccm&lt;/i&gt; context tree * @type {Object} */ const user = ccm.context.find( settings.store, 'user' ); // user exists and must be logged in? =&gt; login user (if not already logged in) user &amp;&amp; settings.login &amp;&amp; await user.login(); // should a user-specific key be used? =&gt; make key user-specific if ( ccm.helper.isInstance( user ) &amp;&amp; settings.user &amp;&amp; user.isLoggedIn() ) settings.key = [ settings.key, user.data().key ]; // get dataset from datastore let dataset = await settings.store.get( settings.key ); // dataset not exists? =&gt; use empty dataset if ( !dataset ) { dataset = { key: settings.key }; if ( settings.permissions ) dataset._ = settings.permissions; } // has converter? =&gt; convert dataset if ( settings.convert ) dataset = await settings.convert( dataset ); return dataset; }; /** * @summary allows a declarative way to perform common finish actions * @description * The original parameters given are not changed (they are cloned).&lt;br&gt; * If an instance is passed for &lt;code&gt;settings&lt;/code&gt;, the finish actions defined via the &lt;code&gt;instance.onfinish&lt;/code&gt; property are used.&lt;br&gt; * If a function is passed for &lt;code&gt;settings&lt;/code&gt;, the function is called with the result data.&lt;br&gt; * If an instance is passed for &lt;code&gt;settings&lt;/code&gt;, the result data are automatically determined via &lt;code&gt;instance.getValue()&lt;/code&gt;. To do this, the instance must have a &lt;code&gt;getValue&lt;/code&gt; method.&lt;br&gt; * If an instance is passed for &lt;code&gt;settings&lt;/code&gt;, the nearest instance for user authentication is automatically determined. * @function * @async * @param {Object|Function} settings - declarative settings for usual finish actions (or 'onfinish' callback or finished instance) * @param {Object} [results] - result data of the finished instance * @param {string} [settings.confirm] - show confirm box (no finish actions will be performed if user chooses abort) * @param {Function} [settings.condition] - no finish actions will be performed if this function returns a falsy value (result data and possibly the instance is passed as parameters) * @param {boolean} [settings.login] - user will be logged in if not already logged in (only works if an instance for user authentication could be determined) * @param {Function} [settings.convert] - for dynamic adjustment of the results data (result data is passed as parameter, must return adjusted result data) * @param {boolean} [settings.log] - log result data in the developer console of the web browser * @param {Object} [settings.clear] - clear webpage area of the finished instance * @param {Object|boolean} [settings.store] - use this to store the result data in a data store (use boolean true to apply the settings of &lt;code&gt;instance.data&lt;/code&gt;\") * @param {Object} settings.store.settings - datastore accessor configuration for a datastore (result data will be set in this datastore) * @param {*} [settings.store.key] - dataset key for result data in the datastore (default is generated key) * @param {boolean} [settings.store.user] - The dataset key is expanded to an user-specific key: &lt;code&gt;[ dataset_key, user_key ]&lt;/code&gt; (only if instance for user authentication is detected and user is logged in) * @param {boolean} [settings.store.unique] - The dataset key is expanded with an generated unique hash: &lt;code&gt;[ dataset_key, user_key, unique_hash ]&lt;/code&gt; * @param {Object} [settings.store.permissions] - If the dataset does not exist, the dataset then will created with these permission settings. * @param {string} [settings.alert] - show alert message * @param {boolean} [settings.restart] - restart finished instance * @param {{component: string, config: Object}|*} [settings.render] - render other content (&lt;i&gt;ccmjs&lt;/i&gt;-based app or HTML content, as default the content is rendered in the root element of the instance) * @param {callback} [settings.callback] - additional finish callback which will be called after the other finish actions (result data and possibly the instance is passed as parameter) * @returns {Promise&lt;void&gt;} * @example * instance.onfinish = { * confirm: 'Are you sure?', * condition: ( results, instance ) =&gt; true, * login: true, * convert: json =&gt; json, * log: true, * clear: true, * store: { * settings: { name: 'store_name', url: 'path/to/server/interface.php' }, * key: 'dataset_key', * user: true, * unique: true, * permissions: { * creator: 'john', * group: { * john: true, * jane: true * }, * access: { * get: 'all', * set: 'group', * del: 'creator' * } * } * }, * alert: 'Finished!', * restart: true, * render: { * component: 'component_url', * config: {...} * }, * callback: ( results, instance ) =&gt; console.log( results, instance ) * }; * onFinish( instance ); * @example * instance.data = { * store: { name: 'store_name', url: 'path/to/server/interface.php' } * key: 'dataset_key', * user: true, * unique: true, * permissions: {...} * }; * instance.onfinish = { * store: true * }; * onFinish( instance ); * @example * onFinish( { render: { * component: 'component_url', * config: { * root: document.body, * ... * } * } } ); * @example * instance.onfinish = { render: 'Hello &lt;b&gt;World&lt;/b&gt;!' }; * onFinish( instance ); * @example * instance.onfinish = { render: { inner: 'Hello World!' } } }; * onFinish( instance ); * @memberOf ModuleHelper.DataWorkflow */ export const onFinish = async ( settings, results ) =&gt; { let instance, user; // no manipulation of original passed parameters (avoids unwanted side effects) settings = ccm.helper.clone( settings ); results = ccm.helper.clone( results ); // has ccm instance? =&gt; take finish actions from 'instance.onfinish' and result data from 'instance.getValue()' if ( ccm.helper.isInstance( settings ) ) { instance = settings; if ( !results &amp;&amp; settings.getValue ) results = settings.getValue(); // determine result data settings = settings.onfinish; // determine finish actions user = ccm.context.find( instance, 'user' ); // determine nearest user instance in the ccm context of the instance } if ( !settings ) return; // no finish actions? =&gt; abort if ( typeof settings === 'function' ) return settings( results, instance ); // are the finish actions defined by function? =&gt; perform function with results if ( settings.confirm &amp;&amp; !confirm( settings.confirm ) ) return; // confirm box if ( settings.condition &amp;&amp; !( await settings.condition( results, instance ) ) ) return; // check condition user &amp;&amp; settings.login &amp;&amp; await user.login(); // login user (if not already logged in) if ( settings.convert ) results = await settings.convert( results, instance ); // adjust result data settings.log &amp;&amp; console.log( results ); // log result data (if necessary) if ( instance &amp;&amp; settings.clear ) instance.element.innerHTML = ''; // clear website area of the instance (if necessary) // store result data in a datastore if ( settings.store &amp;&amp; results ) { /** * deep copy of result data * @type {Object} */ const dataset = ccm.helper.clone( results ); // allow shortcut for update dataset in its original datastore if ( instance &amp;&amp; settings.store === true ) { settings.store = {}; if ( ccm.helper.isObject( instance.data ) &amp;&amp; ccm.helper.isDatastore( instance.data.store ) ) { settings.store = ccm.helper.clone( instance.data ); settings.store.settings = settings.store.store; delete settings.store.store; } } // prepare dataset key dataset.key = settings.store.key || ccm.helper.generateKey(); if ( !Array.isArray( dataset.key ) &amp;&amp; ( settings.store.user || settings.store.unique ) ) dataset.key = [ dataset.key ]; settings.store.user &amp;&amp; user &amp;&amp; user.isLoggedIn() &amp;&amp; dataset.key.push( user.data().key ); settings.store.unique &amp;&amp; dataset.key.push( ccm.helper.generateKey() ); if ( dataset.key.length === 1 ) dataset.key = dataset.key[ 0 ]; if ( settings.store.permissions ) dataset._ = settings.store.permissions; // prepare permission settings if ( user ) settings.store.settings.user = user; // set user instance for datastore await ccm.set( settings.store.settings, dataset ); // store result data in datastore } if ( settings.alert ) alert( settings.alert ); // alert message instance &amp;&amp; settings.restart &amp;&amp; await instance.start(); // restart ccm instance // render other content (ccm-based app or HTML content) if ( settings.render ) if ( ccm.helper.isObject( settings.render ) &amp;&amp; settings.render.component ) { let config = settings.render.config || {}; // determine instance configuration config.root = config.root || instance &amp;&amp; instance.root; // default root element is root of instance config.parent = !settings.render.root &amp;&amp; instance &amp;&amp; instance.parent; // set parent instance await ccm.start( settings.render.component, config ); // render ccm-based app } else instance &amp;&amp; setContent( instance.root, ccm.helper.html( settings.render ), ccm ); // render HTML content // perform additional finish callback settings.callback &amp;&amp; await settings.callback( results, instance ); }; /*------------------------------------------------- DOM Manipulation -------------------------------------------------*/ /** * help functions for DOM Manipulation * @namespace ModuleHelper.DomManipulation */ /** * appends content to an HTML element (contained script tags will be removed) * @function * @param {Element} elem - HTML element * @param {...*} content * @example append( document.body, 'Hello World!' ) * @example append( document.body, 'Hello', ' ', 'World', '!' ) * @example append( document.body, [ 'Hello', ' ', 'World', '!' ] ) * @example append( document.body, [ 'Hello', ' ', [ 'World', '!' ] ] ) * @example append( document.body, { inner: 'Hello World!' } ) * @example append( document.body, 'Hello', [ ' ', [ { inner: 'World' }, '!' ] ] ) * @memberOf ModuleHelper.DomManipulation */ export const append = ( elem, ...content ) =&gt; { // append each content to the HTML element content.forEach( content =&gt; { // is array? =&gt; recursive call for each value if ( Array.isArray( content ) ) return content.forEach( content =&gt; append( elem, content ) ); // append content content = protect( ccm.helper.html( content ) ); if ( typeof content === 'object' ) elem.appendChild( content ); else elem.insertAdjacentHTML( 'beforeend', content ); } ); }; /** * prepends content to a HTML element (contained script tags will be removed) * @function * @param {Element} elem - HTML element * @param {...*} content * @example prepend( document.body, 'Hello World!' ) * @example prepend( document.body, 'Hello', ' ', 'World', '!' ) * @example prepend( document.body, [ 'Hello', ' ', 'World', '!' ] ) * @example prepend( document.body, [ 'Hello', ' ', [ 'World', '!' ] ] ) * @example prepend( document.body, { inner: 'Hello World!' } ) * @example prepend( document.body, 'Hello', [ ' ', [ { inner: 'World' }, '!' ] ] ) * @memberOf ModuleHelper.DomManipulation */ export const prepend = ( elem, ...content ) =&gt; { // prepend each content to the HTML element content.reverse().forEach( content =&gt; { // is array? =&gt; recursive call for each value if ( Array.isArray( content ) ) return content.reverse().forEach( content =&gt; prepend( elem, content ) ); // no child nodes? =&gt; append content if ( !elem.hasChildNodes() ) return append( elem, content ); // prepend content content = protect( ccm.helper.html( content ) ); if ( typeof content === 'object' ) elem.insertBefore( content, elem.firstChild ); else elem.insertAdjacentHTML( 'afterbegin', content ); } ); }; /** * removes an HTML element from its parent * @function * @param {Element} elem - HTML element * @example * const element = document.createElement( 'div' ); * document.body.appendChild( element ); * removeElement( element ); * console.log( element.parentNode ); // =&gt; null * @memberOf ModuleHelper.DomManipulation */ export const remove = elem =&gt; elem &amp;&amp; elem.parentNode &amp;&amp; elem.parentNode.removeChild( elem ); /** * renders a TemplateResult from lit-html in an HTML element * @function * @param {Object} content - TemplateResult from lit-html * @param {Element} elem - HTML element * @memberOf ModuleHelper.DomManipulation */ export const render = ( content, elem ) =&gt; litRender( content, elem ); import { render as litRender } from 'https://unpkg.com/lit-html'; /** * replaces an HTML element with an other HTML element (contained script tags will be removed) * @function * @param {Element} elem - HTML element (must have a parent) * @param {*} other - other HTML element * @example replace( document.querySelector( '#myid' ), '&lt;b&gt;World&lt;/b&gt;' ) * @example replace( document.querySelector( '#myid' ), { tag: 'b', inner: 'World' } ) * @memberOf ModuleHelper.DomManipulation */ export const replace = ( elem, other ) =&gt; elem.parentNode &amp;&amp; elem.parentNode.replaceChild( protect( ccm.helper.html( other ) ), elem ); /** * set the content of an HTML element (contained script tags will be removed) * @function * @param {Element} elem - HTML element * @param {...*} content - new content for the HTML element (old content is cleared) * @example setContent( document.body, 'Hello World!' ) * @example setContent( document.body, 'Hello', ' ', 'World', '!' ) * @example setContent( document.body, [ 'Hello', ' ', 'World', '!' ] ) * @example setContent( document.body, [ 'Hello', ' ', [ 'World', '!' ] ] ) * @example setContent( document.body, { inner: 'Hello World!' } ) * @example setContent( document.body, 'Hello', [ ' ', [ { inner: 'World' }, '!' ] ] ) * @memberOf ModuleHelper.DomManipulation */ export const setContent = ( elem, ...content ) =&gt; { elem.innerHTML = ''; // clear old content append( elem, content ); // append new content }; /*----------------------------------------------- HTML Input Elements ------------------------------------------------*/ /** * helper functions for handling of HTML input elements * @namespace ModuleHelper.InputElements */ /** * fills input elements with values * @function * @param {Element} elem - HTML element which contains the input elements (must not be an HTML form tag) * @param {Object} data - contains the values for the input elements * @example * // &lt;body&gt;&lt;input type=\"text\" name=\"user\"&gt;&lt;input type=\"password\" name=\"secret\"&gt;&lt;/body&gt; * fillForm( document.body, { user: 'JohnDoe', secret: '1aA' } ); * console.log( formData( document.body ) ); // { user: 'JohnDoe', secret: '1aA' } * @example * // &lt;body&gt;&lt;input type=\"checkbox\" name=\"agreed\"&gt;&lt;/body&gt; (boolean checkbox) * fillForm( document.body, { agreed: true } ); * console.log( formData( document.body ) ); // { agreed: true } * @example * // &lt;body&gt;&lt;input type=\"checkbox\" name=\"role\" value=\"Coordinator\"&gt;&lt;/body&gt; (value checkbox) * fillForm( document.body, { role: 'Coordinator' } ); * console.log( formData( document.body ) ); // { role: 'Coordinator' } * @example * // &lt;body&gt;&lt;input type=\"checkbox\" name=\"types\" value=\"A\"&gt;&lt;input type=\"checkbox\" name=\"types\" value=\"B\"&gt;&lt;/body&gt; (multi checkbox) * fillForm( document.body, { types: [ 'A', 'B' ] } ); * console.log( formData( document.body ) ); // { types: [ 'A', 'B' ] } * @example * // &lt;body&gt;&lt;input type=\"radio\" name=\"choice\" value=\"A\"&gt;&lt;input type=\"radio\" name=\"choice\" value=\"B\"&gt;&lt;/body&gt; (radio buttons) * fillForm( document.body, { choice: 'A' } ); * console.log( formData( document.body ) ); // { choice: 'A' } * @example * // &lt;body&gt;&lt;select name=\"item\"&gt;&lt;option value=\"A\"&gt;Item A&lt;/option&gt;&lt;option value=\"B\"&gt;Item B&lt;/option&gt;&lt;/select&gt;&lt;/body&gt; (selector box) * fillForm( document.body, { item: 'A' } ); * console.log( formData( document.body ) ); // { item: 'A' } * @example * // &lt;body&gt;&lt;select name=\"item\"&gt;&lt;option&gt;A&lt;/option&gt;&lt;option&gt;B&lt;/option&gt;&lt;/select&gt;&lt;/body&gt; (selector box without values) * fillForm( document.body, { item: 'A' } ); * console.log( formData( document.body ) ); // { item: 'A' } * @example * // &lt;body&gt;&lt;select multiple name=\"items\"&gt;&lt;option value=\"A\"&gt;Item A&lt;/option&gt;&lt;option value=\"B\"&gt;Item B&lt;/option&gt;&lt;/select&gt;&lt;/body&gt; (multi-selector box) * fillForm( document.body, { items: [ 'A', 'B' ] } ); * console.log( formData( document.body ) ); // { items: [ 'A', 'B' ] } * @example * // &lt;body&gt;&lt;textarea name=\"description\"&gt;&lt;/description&gt;&lt;/body&gt; (textarea) * fillForm( document.body, { description: 'Hello World!' } ); * console.log( formData( document.body ) ); // { description: 'Hello World!' } * @example * // &lt;body&gt;&lt;div contenteditable name=\"topic\"&gt;&lt;/div&gt;&lt;/body&gt; (in-place editing with contenteditable) * fillForm( document.body, { topic: 'Hello World!' } ); * console.log( formData( document.body ) ); // { topic: 'Hello World!' } * @example * // &lt;body&gt;&lt;input type=\"text\" name=\"deep.property.key\"&gt;&lt;/input&gt;&lt;/body&gt; (deep property value) * fillForm( document.body, { 'deep.property.key': 'value' } ); * console.log( formData( document.body ) ); // { deep: { property: { key: 'value' } } } * @example * // &lt;body&gt;&lt;input type=\"text\" name=\"data\"&gt;&lt;/input&gt;&lt;/body&gt; (complex data value) * fillForm( document.body, { data: { number: [ 1, 2, { a: 3 } ], checked: true, value: 'Hello World!' } } ); * console.log( formData( document.body ) ); // { data: { number: [ 1, 2, { a: 3 } ], checked: true, value: 'Hello World!' } } * @memberOf ModuleHelper.InputElements */ export const fillForm = ( elem, data ) =&gt; { data = ccm.helper.clone( data ); const dot = ccm.helper.toDotNotation( data, true ); for ( const key in dot ) data[ key ] = dot[ key ]; for ( const key in data ) { if ( !data[ key ] ) continue; if ( typeof data[ key ] === 'object' ) data[ key ] = encodeJSON( data[ key ], ccm ); elem.querySelectorAll( '[name=\"' + key + '\"]' ).forEach( input =&gt; { if ( input.type === 'checkbox' ) { if ( data[ key ] === input.value ) input.checked = true; else if ( input.value &amp;&amp; typeof data[ key ] === 'string' &amp;&amp; data[ key ].charAt( 0 ) === '[' ) decodeJSON( data[ key ], ccm ).forEach( value =&gt; { if ( value === input.value ) input.checked = true; } ); else input.checked = true; } else if ( input.type === 'radio' ) { if ( data[ key ] === input.value ) input.checked = true; } else if ( input.tagName.toLowerCase() === 'select' ) { if ( input.hasAttribute( 'multiple' ) ) data[ key ] = decodeJSON( data[ key ], ccm ); input.querySelectorAll( 'option' ).forEach( option =&gt; { if ( input.hasAttribute( 'multiple' ) ) data[ key ].forEach( value =&gt; encodeJSON( value, ccm ) === ( option.value ? option.value : option.innerHTML.trim() ) &amp;&amp; ( option.selected = true ) ); else if ( data[ key ] === ( option.value ? option.value : option.innerHTML.trim() ) ) option.selected = true; } ); } else if ( input.value === undefined ) input.innerHTML = protect( data[ key ], ccm ); else input.value = data[ key ]; } ); } }; /** * gets the values of input elements * @function * @param {Element} elem - HTML element which contains the input elements (must not be a HTML form tag) * @param {Object} [settings = {}] - optional additional settings * @param {boolean} [settings.enabled_only] - ignore values from disabled input elements * @returns {Object} values of the input elements * @example * // &lt;body&gt;&lt;input type=\"text\" name=\"user\"&gt;&lt;input type=\"password\" name=\"secret\"&gt;&lt;/body&gt; * fillForm( document.body, { user: 'JohnDoe', secret: '1aA' } ); * console.log( formData( document.body ) ); // { user: 'JohnDoe', secret: '1aA' } * @example * // &lt;body&gt;&lt;input type=\"checkbox\" name=\"agreed\"&gt;&lt;/body&gt; (boolean checkbox) * fillForm( document.body, { agreed: true } ); * console.log( formData( document.body ) ); // { agreed: true } * @example * // &lt;body&gt;&lt;input type=\"checkbox\" name=\"role\" value=\"Coordinator\"&gt;&lt;/body&gt; (value checkbox) * fillForm( document.body, { role: 'Coordinator' } ); * console.log( formData( document.body ) ); // { role: 'Coordinator' } * @example * // &lt;body&gt;&lt;input type=\"checkbox\" name=\"types\" value=\"A\"&gt;&lt;input type=\"checkbox\" name=\"types\" value=\"B\"&gt;&lt;/body&gt; (multi checkbox) * fillForm( document.body, { types: [ 'A', 'B' ] } ); * console.log( formData( document.body ) ); // { types: [ 'A', 'B' ] } * @example * // &lt;body&gt;&lt;input type=\"radio\" name=\"choice\" value=\"A\"&gt;&lt;input type=\"radio\" name=\"choice\" value=\"B\"&gt;&lt;/body&gt; (radio buttons) * fillForm( document.body, { choice: 'A' } ); * console.log( formData( document.body ) ); // { choice: 'A' } * @example * // &lt;body&gt;&lt;select name=\"item\"&gt;&lt;option value=\"A\"&gt;Item A&lt;/option&gt;&lt;option value=\"B\"&gt;Item B&lt;/option&gt;&lt;/select&gt;&lt;/body&gt; (selector box) * fillForm( document.body, { item: 'A' } ); * console.log( formData( document.body ) ); // { item: 'A' } * @example * // &lt;body&gt;&lt;select name=\"item\"&gt;&lt;option&gt;A&lt;/option&gt;&lt;option&gt;B&lt;/option&gt;&lt;/select&gt;&lt;/body&gt; (selector box without values) * fillForm( document.body, { item: 'A' } ); * console.log( formData( document.body ) ); // { item: 'A' } * @example * // &lt;body&gt;&lt;select multiple name=\"items\"&gt;&lt;option value=\"A\"&gt;Item A&lt;/option&gt;&lt;option value=\"B\"&gt;Item B&lt;/option&gt;&lt;/select&gt;&lt;/body&gt; (multi-selector box) * fillForm( document.body, { items: [ 'A', 'B' ] } ); * console.log( formData( document.body ) ); // { items: [ 'A', 'B' ] } * @example * // &lt;body&gt;&lt;textarea name=\"description\"&gt;&lt;/description&gt;&lt;/body&gt; (textarea) * fillForm( document.body, { description: 'Hello World!' } ); * console.log( formData( document.body ) ); // { description: 'Hello World!' } * @example * // &lt;body&gt;&lt;div contenteditable name=\"topic\"&gt;&lt;/div&gt;&lt;/body&gt; (in-place editing with contenteditable) * fillForm( document.body, { topic: 'Hello World!' } ); * console.log( formData( document.body ) ); // { topic: 'Hello World!' } * @example * // &lt;body&gt;&lt;input type=\"text\" name=\"deep.property.key\"&gt;&lt;/input&gt;&lt;/body&gt; (deep property value) * fillForm( document.body, { 'deep.property.key': 'value' } ); * console.log( formData( document.body ) ); // { deep: { property: { key: 'value' } } } * @example * // &lt;body&gt;&lt;input type=\"text\" name=\"data\"&gt;&lt;/input&gt;&lt;/body&gt; (complex data value) * fillForm( document.body, { data: { number: [ 1, 2, { a: 3 } ], checked: true, value: 'Hello World!' } } ); * console.log( formData( document.body ) ); // { data: { number: [ 1, 2, { a: 3 } ], checked: true, value: 'Hello World!' } } * @example * // &lt;body&gt;&lt;input type=\"text\" name=\"user\"&gt;&lt;input type=\"password\" name=\"secret\" disabled&gt;&lt;/body&gt; * fillForm( document.body, { user: 'JohnDoe', secret: '1aA' } ); * console.log( formData( document.body, { enabled_only: true } ) ); // { user: 'JohnDoe' } * @memberOf ModuleHelper.InputElements */ export const formData = ( elem, settings = {} ) =&gt; { const data = {}; elem.querySelectorAll( '[name]' ).forEach( input =&gt; { if ( settings.enabled_only &amp;&amp; input.disabled ) return; let name = input.getAttribute( 'name' ); if ( input.type === 'checkbox' ) { const value = input.checked ? ( input.value === 'on' ? true : input.value ) : ( input.value === 'on' ? false : '' ); const multi = [ ...elem.querySelectorAll( '[name=\"' + name + '\"]' ) ].length &gt; 1; if ( multi ) { if ( !data[ name ] ) data[ name ] = []; value &amp;&amp; data[ name ].push( value ); } else data[ name ] = value; } else if ( input.type === 'radio' ) data[ name ] = input.checked ? input.value : ( data[ name ] ? data[ name ] : '' ); else if ( input.tagName.toLowerCase() === 'select' ) { let result = []; if ( input.hasAttribute( 'multiple' ) ) input.querySelectorAll( 'option' ).forEach( option =&gt; option.selected &amp;&amp; result.push( option.value ? option.value : option.inner ) ); else input.querySelectorAll( 'option' ).forEach( option =&gt; { if ( option.selected ) result = option.value ? option.value : option.inner; } ); data[ name ] = result; } else if ( input.type === 'number' || input.type === 'range' ) { let value = parseInt( input.value ); if ( isNaN( value ) ) value = ''; data[ name ] = value; } else if ( input.value !== undefined ) data[ name ] = input.value; else data[ input.getAttribute( 'name' ) ] = input.innerHTML; try { if ( typeof data[ name ] === 'string' ) if ( ccm.helper.regex( 'json' ).test( data[ name ] ) ) data[ name ] = decodeJSON( data[ name ], ccm ); } catch ( err ) {} } ); return ccm.helper.solveDotNotation( data ); }; /*--------------------------------------------------- Handover App ---------------------------------------------------*/ /** * helper functions for handover of an app * @namespace ModuleHelper.HandoverApp */ /** * @summary returns the URL of a &lt;i&gt;ccmjs&lt;/i&gt;-based app * @description * The entire instance configuration is included in the app URL.&lt;br&gt; * If the instance configuration is in a datastore, it can also be linked via a data dependency instead.&lt;br&gt; * For this purpose, an object with the datastore accessor configuration and the dataset key must be passed instead of the instance configuration.&lt;br&gt; * Instead of a datastore accessor configuration an already created datastore accessor could also be passed. * @function * @param {string} component - URL of the component on which the app is based. * @param {Object} [config={}] - configuration for the instance that is created from the component to build the app. * @param {string} [url=\"https://ccmjs.github.io/digital-maker-space/app.html\"] - URL of the webpage which shows the app * @example // with default configuration * appURL( 'https://ccmjs.github.io/akless-components/blank/ccm.blank.js' ) * // https://ccmjs.github.io/digital-maker-space/app.html#component=https://ccmjs.github.io/akless-components/blank/ccm.blank.js&amp;config={} * @example // with individual configuration * appURL( 'https://ccmjs.github.io/akless-components/multi_blank/ccm.multi_blank.js', { times: 5 } ) * // https://ccmjs.github.io/digital-maker-space/app.html#component=https://ccmjs.github.io/akless-components/multi_blank/ccm.multi_blank.js&amp;config={\"times\":5} * @example // with individual configuration that is stored in a datastore * appURL( 'https://ccmjs.github.io/akless-components/cloze/versions/ccm.cloze-6.0.3.js', { store: 'https://ccmjs.github.io/akless-components/cloze/resources/configs.js', key: 'demo' } ) * // https://ccmjs.github.io/digital-maker-space/app.html#component=https://ccmjs.github.io/akless-components/cloze/versions/ccm.cloze-6.0.3.js&amp;config={\"store\":\"https://ccmjs.github.io/akless-components/cloze/resources/configs.js\",\"key\":\"demo\"} * @example // pass an already created datastore instead of a datastore accessor configuration * appURL( 'https://ccmjs.github.io/akless-components/cloze/versions/ccm.cloze-6.0.3.js', { store: await ccm.store( { name: 'cloze', url: 'https://ccm2.inf.h-brs.de' } ), key: 'demo' } ) * // https://ccmjs.github.io/digital-maker-space/app.html#component=https://ccmjs.github.io/akless-components/cloze/versions/ccm.cloze-6.0.3.js&amp;config={\"store\":{\"name\":\"cloze\",\"url\":\"https://ccm2.inf.h-brs.de\"},\"key\":\"demo\"} * @returns {string} * @memberOf ModuleHelper.HandoverApp */ export const appURL = ( component, config = {}, url = 'https://ccmjs.github.io/digital-maker-space/app.html' ) =&gt; { if ( ccm.helper.isDatastore( config.store ) ) config.store = config.store.source(); return `${url}#component=${encodeURIComponent(component)}&amp;config=${encodeURIComponent(ccm.helper.stringify(config))}`; }; /** * decomposes a given app URL of a &lt;i&gt;ccmjs&lt;/i&gt;-based app into component URL and instance configuration * @function * @param {string} app_url - URL of the app * @returns {{component:string,config:Object}} * @example * decomposeAppURL( 'https://ccmjs.github.io/digital-maker-space/app.html#component=https://ccmjs.github.io/akless-components/blank/ccm.blank.js&amp;config={}' ) * // { component: 'https://ccmjs.github.io/akless-components/blank/ccm.blank.js' } * @example * decomposeAppURL( 'https://ccmjs.github.io/digital-maker-space/app.html#component=https://ccmjs.github.io/akless-components/multi_blank/ccm.multi_blank.js&amp;config={\"times\":5}' ) * // { component: 'https://ccmjs.github.io/akless-components/multi_blank/ccm.multi_blank.js', config: { times: 5 } } * @example * decomposeAppURL( 'https://ccmjs.github.io/digital-maker-space/app.html#component=https://ccmjs.github.io/akless-components/cloze/versions/ccm.cloze-6.0.3.js&amp;config={\"store\":\"https://ccmjs.github.io/akless-components/cloze/resources/configs.js\",\"key\":\"demo\"}' ) * // { component: 'https://ccmjs.github.io/akless-components/cloze/versions/ccm.cloze-6.0.3.js', config: { store: 'https://ccmjs.github.io/akless-components/cloze/resources/configs.js', key: 'demo' } } * @memberOf ModuleHelper.HandoverApp */ export const decomposeAppURL = app_url =&gt; { // decompose app URL const result = {}; try { app_url = decodeURIComponent( app_url ); } catch ( e ) {} app_url.substr( app_url.indexOf( '#' ) + 1 ).split( '&amp;' ).forEach( part =&gt; { part = part.split( '=' ); result[ part[ 0 ] ] = part[ 1 ]; } ); // adjust config if ( result.config ) if ( result.config === '{}' ) delete result.config; else result.config = JSON.parse( result.config ); return result; }; /** * decomposes a given embed code of a &lt;i&gt;ccmjs&lt;/i&gt;-based app into component URL and instance configuration * @function * @param {string} embed_code - embed code of the app * @returns {{component:string,config:Object}} * @example * decomposeEmbedCode( `&lt;script src='https://ccmjs.github.io/akless-components/blank/ccm.blank.js'&gt;&lt;/script&gt;&lt;ccm-blank key='{}'&gt;&lt;/ccm-blank&gt;` ) * // { component: 'https://ccmjs.github.io/akless-components/blank/ccm.blank.js' } * @example * decomposeEmbedCode( `&lt;script src='https://ccmjs.github.io/akless-components/multi_blank/ccm.multi_blank.js'&gt;&lt;/script&gt;&lt;ccm-multi_blank key='{\"times\":5}'&gt;&lt;/ccm-multi_blank&gt;` ) * // { component: 'https://ccmjs.github.io/akless-components/multi_blank/ccm.multi_blank.js', config: { times: 5 } } * @example * decomposeEmbedCode( `&lt;script src='https://ccmjs.github.io/akless-components/cloze/versions/ccm.cloze-6.0.3.js'&gt;&lt;/script&gt;&lt;ccm-cloze-6-0-3 key='[\"ccm.get\",\"https://ccmjs.github.io/akless-components/cloze/resources/configs.js\",\"demo\"]'&gt;&lt;/ccm-cloze-6-0-3&gt;` ) * // { component: 'https://ccmjs.github.io/akless-components/cloze/versions/ccm.cloze-6.0.3.js', config: { store: 'https://ccmjs.github.io/akless-components/cloze/resources/configs.js', key: 'demo' } } * @example * decomposeEmbedCode( `&lt;ccm-app component='https://ccmjs.github.io/akless-components/blank/ccm.blank.js' key='{}'&gt;&lt;/ccm-app&gt;` ) * // { component: 'https://ccmjs.github.io/akless-components/blank/ccm.blank.js' } * @example * decomposeEmbedCode( `&lt;ccm-app component='https://ccmjs.github.io/akless-components/multi_blank/ccm.multi_blank.js' key='{\"times\":5}'&gt;&lt;/ccm-app&gt;` ) * // { component: 'https://ccmjs.github.io/akless-components/multi_blank/ccm.multi_blank.js', config: { times: 5 } } * @example * decomposeEmbedCode( `&lt;ccm-app component='https://ccmjs.github.io/akless-components/cloze/versions/ccm.cloze-6.0.3.js' key='[\"ccm.get\",\"https://ccmjs.github.io/akless-components/cloze/resources/configs.js\",\"demo\"]'&gt;&lt;/ccm-app&gt;` ) * // { component: 'https://ccmjs.github.io/akless-components/cloze/versions/ccm.cloze-6.0.3.js', config: { store: 'https://ccmjs.github.io/akless-components/cloze/resources/configs.js', key: 'demo' } } * @memberOf ModuleHelper.HandoverApp */ export const decomposeEmbedCode = embed_code =&gt; { // decompose embed code embed_code = ccm.helper.html( `&lt;div&gt;${embed_code}&lt;/div&gt;`, undefined, { no_evaluation: true } ); const result = { component: embed_code.firstChild.getAttribute( 'src' ) || embed_code.firstChild.getAttribute( 'component' ), config: embed_code.lastChild.getAttribute( 'key' ) }; // adjust config if ( result.config ) if ( result.config === '{}' ) delete result.config; else result.config = JSON.parse( result.config ); // config is a data dependency? =&gt; use object with store and key for config if ( Array.isArray( result.config ) ) result.config = { store: result.config[ 1 ], key: result.config[ 2 ] }; return result; }; /** * provides a download of a &lt;i&gt;ccmja&lt;/i&gt;-based app as HTML file * @function * @param {string} embed_code - embed code (with included script tag) of the app * @param {string} [filename='app'] - filename without file extension * @param {string} [title='App'] - title of the webpage * @param {string} [template='https://ccmjs.github.io/akless-components/resources/templates/app.html'] - URL of the HTML template file * @returns {Promise&lt;void&gt;} * @example * const embed_code = \"&lt;script src='https://ccmjs.github.io/akless-components/blank/ccm.blank.js'&gt;&lt;/sc\"+\"ript&gt;&lt;ccm-blank key='{}'&gt;&lt;/ccm-blank&gt;\"; * downloadApp( embed_code, 'blank', 'Blank App' ); * @memberOf ModuleHelper.HandoverApp */ export const downloadApp = async ( embed_code, filename = 'app', title = 'App', template = 'https://ccmjs.github.io/akless-components/resources/templates/app.html' ) =&gt; { template = await fetch( template ).then( response =&gt; response.text() ); // load content of HTML template file template = template.replace( '__TITLE__', title ).replace( '__EMBED__', embed_code ); // integrate title and embed code download( `${filename}.html`, template ); // provide download of HTML file }; /** * @summary generates the HTML embed code of a &lt;i&gt;ccmjs&lt;/i&gt;-based app * @description * The entire instance configuration is included in the embed code.&lt;br&gt; * If the instance configuration is in a datastore, it can also be linked via a data dependency instead.&lt;br&gt; * For this purpose, an object with the datastore accessor configuration and the dataset key must be passed instead of the instance configuration.&lt;br&gt; * Instead of a datastore accessor configuration an already created datastore accessor could also be passed.&lt;br&gt; * If the embed code does not contain a script tag, it will only work if a &lt;i&gt;ccmjs&lt;/i&gt; version is already present in the webpage. * @function * @param {string} component - URL of the component on which the app is based. * @param {Object} [config={}] - configuration for the instance that is created from the component to build the app. * @param {boolean} [noscript] - embed code does not contain a script tag * @returns {string} generated embed code * @example // with default configuration * embedCode( 'https://ccmjs.github.io/akless-components/blank/ccm.blank.js' ) * // &lt;script src='https://ccmjs.github.io/akless-components/blank/ccm.blank.js'&gt;&lt;/script&gt;&lt;ccm-blank key='{}'&gt;&lt;/ccm-blank&gt; * @example // with individual configuration * embedCode( 'https://ccmjs.github.io/akless-components/multi_blank/ccm.multi_blank.js', { times: 5 } ) * // &lt;script src='https://ccmjs.github.io/akless-components/multi_blank/ccm.multi_blank.js'&gt;&lt;/script&gt;&lt;ccm-multi_blank key='{\"times\":5}'&gt;&lt;/ccm-multi_blank&gt; * @example // with individual configuration that is stored in a datastore * embedCode( embedCode( 'https://ccmjs.github.io/akless-components/cloze/versions/ccm.cloze-6.0.3.js', { store: 'https://ccmjs.github.io/akless-components/cloze/resources/configs.js', key: 'demo' } ) ) * // &lt;script src='https://ccmjs.github.io/akless-components/cloze/versions/ccm.cloze-6.0.3.js'&gt;&lt;/script&gt;&lt;ccm-cloze-6-0-3 key='[\"ccm.get\",\"https://ccmjs.github.io/akless-components/cloze/resources/configs.js\",\"demo\"]'&gt;&lt;/ccm-cloze-6-0-3&gt; * @example // pass an already created datastore accessor instead of a datastore accessor configuration * embedCode( 'https://ccmjs.github.io/akless-components/cloze/versions/ccm.cloze-6.0.3.js', { store: await ccm.store( { name: 'cloze', url: 'https://ccm2.inf.h-brs.de' } ), key: 'demo' } ) * // &lt;script src='https://ccmjs.github.io/akless-components/cloze/versions/ccm.cloze-6.0.3.js'&gt;&lt;/script&gt;&lt;ccm-cloze-6-0-3 key='[\"ccm.get\",{\"name\":\"cloze\",\"url\":\"https://ccm2.inf.h-brs.de\"},\"demo\"]'&gt;&lt;/ccm-cloze-6-0-3&gt; * @example // with no script tag and default configuration * embedCode( 'https://ccmjs.github.io/akless-components/blank/ccm.blank.js', undefined, true ) * // &lt;ccm-app component='https://ccmjs.github.io/akless-components/blank/ccm.blank.js' key='{}'&gt;&lt;/ccm-app&gt; * @example // with no script tag and individual configuration * embedCode( 'https://ccmjs.github.io/akless-components/multi_blank/ccm.multi_blank.js', { times: 5 }, true ) * // &lt;ccm-app component='https://ccmjs.github.io/akless-components/multi_blank/ccm.multi_blank.js' key='{\"times\":5}'&gt;&lt;/ccm-app&gt; * @example // with no script tag and individual configuration that is stored in a datastore * embedCode( 'https://ccmjs.github.io/akless-components/cloze/versions/ccm.cloze-6.0.3.js', { store: 'https://ccmjs.github.io/akless-components/cloze/resources/configs.js', key: 'demo' }, true ) * // &lt;ccm-app component='https://ccmjs.github.io/akless-components/cloze/versions/ccm.cloze-6.0.3.js' key='[\"ccm.get\",\"https://ccmjs.github.io/akless-components/cloze/resources/configs.js\",\"demo\"]'&gt;&lt;/ccm-app&gt; * @example // with no script tag and an already created datastore accessor is passed instead of a datastore accessor configuration * embedCode( 'https://ccmjs.github.io/akless-components/cloze/versions/ccm.cloze-6.0.3.js', { store: await ccm.store( { name: 'cloze', url: 'https://ccm2.inf.h-brs.de' } ), key: 'demo' }, true ) * // &lt;ccm-app component='https://ccmjs.github.io/akless-components/cloze/versions/ccm.cloze-6.0.3.js' key='[\"ccm.get\",{\"name\":\"cloze\",\"url\":\"https://ccm2.inf.h-brs.de\"},\"demo\"]'&gt;&lt;/ccm-app&gt; * @memberOf ModuleHelper.HandoverApp */ export const embedCode = ( component, config = {}, noscript ) =&gt; { /** * index of the component * @type {string} */ const index = ccm.helper.convertComponentURL( component ).index; // instance configuration comes from a datastore? =&gt; use data dependency if ( config.store &amp;&amp; config.key ) config = [ 'ccm.get', ccm.helper.isDatastore( config.store ) ? config.store.source() : config.store, config.key ]; if ( noscript ) return `&lt;ccm-app component='${component}' key='${ccm.helper.stringify(config)}'&gt;&lt;/ccm-app&gt;`; else return `&lt;script src='${component}'&gt;&lt;/script&gt;&lt;ccm-${index} key='${ccm.helper.stringify(config)}'&gt;&lt;/ccm-${index}&gt;`; }; /** * provides a download of a &lt;i&gt;ccmjs&lt;/i&gt;-based app as iBook Widget (ZIP file) * @function * @async * @param {string} embed_code - embed code (with included script tag) of the app * @param {string} [filename='app'] - filename without file extension * @param {string} [title='App'] - website title for the index.html * @param {string} [folder='app'] - name of the folder inside the iBook Widget * @param {string} [template='https://ccmjs.github.io/akless-components/resources/templates/app.html'] - URL of the HTML template * @param {string} [info_file='https://ccmjs.github.io/akless-components/resources/templates/ibook_widget/Info.plist'] - URL of the info file * @param {string} [image_file='https://ccmjs.github.io/akless-components/resources/templates/ibook_widget/Default.png'] - URL of the image file * @returns {Promise&lt;void&gt;} * @example * const embed_code = \"&lt;script src='https://ccmjs.github.io/akless-components/blank/ccm.blank.js'&gt;&lt;/sc\"+\"ript&gt;&lt;ccm-blank key='{}'&gt;&lt;/ccm-blank&gt;\"; * iBookWidget( embed_code, 'blank', 'Blank App', 'blank_app' ); * @memberOf ModuleHelper.HandoverApp */ export const iBookWidget = async ( embed_code, filename = 'app', title = 'App', folder='app', template = 'https://ccmjs.github.io/akless-components/resources/templates/app.html', info_file = 'https://ccmjs.github.io/akless-components/resources/templates/ibook_widget/Info.plist', image_file = 'https://ccmjs.github.io/akless-components/resources/templates/ibook_widget/Default.png' ) =&gt; { template = await fetch( template ).then( response =&gt; response.text() ); // load content of HTML template file template = template.replace( '__TITLE__', title ).replace( '__EMBED__', embed_code ); // integrate title and embed code info_file = await fetch( info_file ).then( response =&gt; response.blob() ); // load content of info file image_file = await fetch( image_file ).then( response =&gt; response.blob() ); // load content of image file // generate ZIP file !window.JSZip &amp;&amp; await loadScript( 'https://ccmjs.github.io/akless-components/libs/jszip/jszip.min.js' ); !window.saveAs &amp;&amp; await loadScript( 'https://ccmjs.github.io/akless-components/libs/FileSaver/FileSaver.js' ); let widgetZip = new JSZip(); widgetZip.folder( `${folder}.wdgt` ).file( 'index.html', template ); widgetZip.folder( `${folder}.wdgt` ).file( 'Info.plist', info_file ); widgetZip.folder( `${folder}.wdgt` ).file( 'Default.png', image_file ); widgetZip = await widgetZip.generateAsync( { type: 'blob' } ); // provide download of generated ZIP file saveAs( widgetZip, `${filename}.zip`); }; /** * provides a download of a &lt;i&gt;ccmjs&lt;/i&gt;-based app as SCORM package (ZIP file) * @function * @async * @param {string} embed_code - embed code (with included script tag) of the app * @param {string} [filename='app'] - filename without file extension * @param {string} [title='App'] - website title within the manifest * @param {string} [identifier='App'] - identifier within the manifest * @param {string} [html_template='https://ccmjs.github.io/akless-components/resources/templates/scorm/index.html'] - URL of HTML template * @param {string} [manifest_template='https://ccmjs.github.io/akless-components/resources/templates/scorm/imsmanifest.xml'] - URL of manifest template * @param {string} [api_file='https://ccmjs.github.io/akless-components/resources/templates/scorm/SCORM_API_wrapper.js'] - URL of SCORM API file * @returns {Promise&lt;void&gt;} * @example * const embed_code = \"&lt;script src='https://ccmjs.github.io/akless-components/blank/ccm.blank.js'&gt;&lt;/sc\"+\"ript&gt;&lt;ccm-blank key='{}'&gt;&lt;/ccm-blank&gt;\"; * scorm( embed_code, 'blank', 'Blank App', 'blank_app' ); * @memberOf ModuleHelper.HandoverApp */ export const scorm = async ( embed_code, filename = 'app', title = 'App', identifier = 'App', html_template = 'https://ccmjs.github.io/akless-components/resources/templates/scorm/index.html', manifest_template = 'https://ccmjs.github.io/akless-components/resources/templates/scorm/imsmanifest.xml', api_file = 'https://ccmjs.github.io/akless-components/resources/templates/scorm/SCORM_API_wrapper.js' ) =&gt; { html_template = await fetch( html_template ).then( response =&gt; response.text() ); // load content of HTML template file html_template = html_template.replace( '__TITLE__', title ).replace( '__EMBED__', embed_code ); // integrate title and embed code in HTML template manifest_template = await fetch( manifest_template ).then( response =&gt; response.text() ); // load content of manifest template file manifest_template.replace( '__IDENTIFIER__', identifier ).replace( '__TITLE__', title ); // integrate identifier and title in manifest template api_file = await fetch( api_file ).then( response =&gt; response.blob() ); // load content of SCORM API file // generate ZIP file !window.JSZip &amp;&amp; await loadScript( 'https://ccmjs.github.io/akless-components/libs/jszip/jszip.min.js' ); !window.saveAs &amp;&amp; await loadScript( 'https://ccmjs.github.io/akless-components/libs/FileSaver/FileSaver.js' ); let widgetZip = new JSZip(); widgetZip.file( 'index.html', html_template ); widgetZip.file( 'imsmanifest.xml', manifest_template ); widgetZip.file( 'SCORM_API_wrapper.js', api_file ); widgetZip = await widgetZip.generateAsync( { type: 'blob' } ); // provide download of generated ZIP file saveAs( widgetZip, `${filename}.zip` ); }; /*------------------------------------------------------ Others ------------------------------------------------------*/ /** * not categorizable helper functions * @namespace ModuleHelper.Others */ /** * copies text inside an HTML element to clipboard * @function * @param {Element} elem - HTML element * @example * // &lt;body&gt;&lt;input type=\"text\" value=\"Hello World!\"&gt;&lt;/body&gt; * copyToClipboard( document.body.querySelector( 'input' ) ) * // STRG+V then pastes 'Hello, World!' from clipboard * @memberOf ModuleHelper.Others */ export const copyToClipboard = elem =&gt; { elem.select(); document.execCommand( 'copy' ); } /** * provides a download of an on-the-fly created file * @function * @param {string} filename - filename including file extension * @param {string} content - content of the file * @param {string} [mime='text/html;charset=utf-8'] - media type followed by charset or 'base64' if non-textual * @example download( 'hello_world.html', '&lt;!DOCTYPE html&gt;&lt;meta charset=\"utf-8\"&gt;Hello World!' ) * @memberOf ModuleHelper.Others */ export const download = ( filename, content, mime = 'text/html;charset=utf-8' ) =&gt; { const element = document.createElement( 'a' ); element.setAttribute( 'href', `data:${mime},${encodeURIComponent(content)}` ); element.setAttribute( 'download', filename ); element.style.display = 'none'; document.body.appendChild( element ); element.click(); document.body.removeChild( element ); }; /** * shows the content of a webpage area in fullscreen mode * @function * @param {Element} elem - webpage area * @example * // &lt;body&gt;&lt;div id=\"app\"&gt;Hello World!&lt;/div&gt;&lt;/body&gt; * fullscreen( document.body.querySelector( '#app' ) ) * @memberOf ModuleHelper.Others */ export const fullscreen = elem =&gt; { if ( elem.requestFullscreen ) elem.requestFullscreen(); else if ( elem.mozRequestFullScreen ) /* Firefox */ elem.mozRequestFullScreen(); else if ( elem.webkitRequestFullscreen ) /* Chrome, Safari and Opera */ elem.webkitRequestFullscreen(); else if ( elem.msRequestFullscreen ) /* IE/Edge */ elem.msRequestFullscreen(); }; /** * executes the included code of a JavaScript file * @function * @async * @param {string} url - URL of the JavaScript file * @returns {Promise&lt;void&gt;} * @example await loadScript( 'https://ccmjs.github.io/akless-components/libs/jszip/jszip.min.js' ) * @example await loadScript( 'https://ccmjs.github.io/akless-components/libs/FileSaver/FileSaver.js' ) * @memberOf ModuleHelper.Others */ export const loadScript = async url =&gt; new Promise( ( resolve, reject ) =&gt; { const script = document.createElement( 'script' ); document.head.appendChild( script ); script.onload = () =&gt; { document.head.removeChild( script ); resolve(); }; script.onerror = () =&gt; { document.head.removeChild( script ); reject(); }; script.async = true; script.src = url; } ); /** * appends a progress bar to a DOM element * @function * @param {Element} elem - progress bar will be appended to this element * @param {number} [actual = 0] - actual points * @param {number} [total = 100] - maximum points * @example progressBar( document.body, 60 ) * @example progressBar( document.body, 40, 120 ) * @memberOf ModuleHelper.Others */ export const progressBar = ( elem, actual = 0, total = 100 ) =&gt; { const main = document.createElement( 'div' ); main.innerHTML = `&lt;div&gt;${actual}/${total}&lt;/div&gt;&lt;div&gt;&lt;div&gt;&lt;/div&gt;&lt;/div&gt;`; main.setAttribute( 'style', 'min-width: 200px; max-width: 90%; margin: 1em 5%; padding: 0.5em 1em; display: flex; align-items: center; border: 1px solid lightgray; border-radius: 20px;' ); elem.appendChild( main ); const points = main.querySelector( 'div &gt; div:first-child' ); points.setAttribute( 'style', 'font-family: Verdana, Arial, sans-serif; font-size: 15px; font-stretch: expanded; margin-right: 0.5em; top: 2px;' ); const progress_bar = main.querySelector( 'div &gt; div:last-child' ); progress_bar.setAttribute( 'style', 'width: 100%; height: 20px; background-color: #ddd; border-radius: 10px; overflow: hidden; position: relative;' ); const progress = progress_bar.querySelector( 'div' ); progress.setAttribute( 'style', 'width: 0%; height: 20px; background-color: #4CAF50; position: absolute;' ); setTimeout( () =&gt; { const goal = actual * progress_bar.offsetWidth / total; let width = 1; let id = setInterval( () =&gt; width &gt;= goal ? clearInterval( id ) : progress.style.width = ++width + 'px', 8 ); }, 8 ); }; /*----------------------------------------------------- Security -----------------------------------------------------*/ /** * helper functions for security handling * @namespace ModuleHelper.Security */ /** * @summary checks user permissions * @description * A dataset without permission settings is public data =&gt; access granted.&lt;br&gt; * Time-dependent permissions are not checked on client-side =&gt; access granted.&lt;br&gt; * The realm of user and of the permission settings must be the same.&lt;br&gt; * The creator has always all access right =&gt; access granted.&lt;br&gt; * @function * @param {Object} [settings] - permission settings or dataset with contained permission settings * @param {Object} [user] - user data or user instance that holds the user data * @param {string} operation - data operation that has to check: \"get\" (read), \"set\" (update) or \"del\" (delete) * @returns {boolean} true: access granted, false: access denied * @example * const settings = { creator: 'john', realm: 'guest', access: 'all' }; * const user = { key: 'jane', realm: 'guest' }; * hasPermission( settings, user, 'get' ); // =&gt; true: access granted * @example * const dataset = { _: { * creator: 'john', * realm: 'guest', * group: [ 'john', 'jane' ], * access: { get: 'all', set: 'group', del: 'creator' } * } }; * const user = { key: 'jane', realm: 'guest' }; * hasPermission( dataset, user, 'set' ); // =&gt; true: access granted * @example * const dataset = { _: { * creator: 'john', * realm: 'guest', * group: { * students: [ 'john', 'jane' ], * teachers: [ 'jake' ] * }, * access: { get: 'all', set: 'students,teachers', del: 'teachers' } * } }; * const user = { key: 'jane', realm: 'guest' }; * hasPermission( dataset, user, 'del' ); // =&gt; false: access denied * @memberOf ModuleHelper.Security */ export const hasPermission = ( settings, user, operation ) =&gt; { settings = settings._ ? settings._ : settings; // get permission settings if ( user &amp;&amp; user.getValue ) user = user.getValue(); // get user data from ccm user instance if ( !settings || !settings.creator || !settings.realm ) return true; // dataset without permission settings? =&gt; access granted (public data) if ( Array.isArray( settings.access ) ) return true; // is time-dependent? =&gt; access granted (not checked on client-side) /** * access rights * @type {string|{get:string,set:string,del:string}} */ const access = typeof settings.access === 'object' ? settings.access[ operation ] : settings.access; if ( access === 'all' ) return true; // everyone has permission? =&gt; access granted (public data) if ( !user || !user.key || user.realm !== settings.realm ) return false; // no user or wrong realm? =&gt; access denied if ( user.key === settings.creator ) return true; // user is creator? =&gt; access granted if ( access === 'group' ) return Array.isArray( settings.group ) &amp;&amp; settings.group.includes( user.key ); // permission for group? =&gt; access granted if user is a group member /** * name of groups that have permission * @type {string[]} */ const groups = access.split( ',' ); // access granted if user is a member in any of these groups for ( let i = 0; i &lt; groups.length; i++ ) if ( settings.group &amp;&amp; settings.group[ groups[ i ] ] &amp;&amp; settings.group[ groups[ i ] ].includes( user.key ) ) return true; return false; // user is not a member of any group =&gt; access denied }; /** * checks if a user is the creator of a dataset * @function * @param {Object} dataset - dataset with contained permission settings * @param {Object} user - user data or user instance that holds the user data * @returns {boolean} * @example * const dataset = { _: { creator: 'john', realm: 'guest', access: 'all' } }; * const user = { key: 'john', realm: 'guest' }; * isCreator( dataset, user ); // =&gt; true * @memberOf ModuleHelper.Security */ export const isCreator = ( dataset, user ) =&gt; { if ( user.getValue ) user = user.getValue(); return user &amp;&amp; dataset &amp;&amp; dataset._ &amp;&amp; user.key &amp;&amp; user.key === dataset._.creator &amp;&amp; user.realm &amp;&amp; user.realm === dataset._.realm; }; /** * @summary privatizes public members of an instance * @description * Deletes all given properties in an object and returns another object with the deleted properties and there values.&lt;br&gt; * If no properties are given, then all not &lt;i&gt;ccmjs&lt;/i&gt; relevant instance members will be privatized.&lt;br&gt; * List of &lt;i&gt;ccmjs&lt;/i&gt; relevant properties that will not be privatized: * &lt;ul&gt; * &lt;li&gt;&lt;code&gt;ccm&lt;/code&gt;&lt;/li&gt; * &lt;li&gt;&lt;code&gt;component&lt;/code&gt;&lt;/li&gt; * &lt;li&gt;&lt;code&gt;config&lt;/code&gt;&lt;/li&gt; * &lt;li&gt;&lt;code&gt;element&lt;/code&gt;&lt;/li&gt; * &lt;li&gt;&lt;code&gt;id&lt;/code&gt;&lt;/li&gt; * &lt;li&gt;&lt;code&gt;index&lt;/code&gt;&lt;/li&gt; * &lt;li&gt;&lt;code&gt;inner&lt;/code&gt;&lt;/li&gt; * &lt;li&gt;&lt;code&gt;parent&lt;/code&gt;&lt;/li&gt; * &lt;li&gt;&lt;code&gt;root&lt;/code&gt;&lt;/li&gt; * &lt;li&gt;&lt;code&gt;shadow&lt;/code&gt;&lt;/li&gt; * &lt;/ul&gt; * In addition to this: All functions and depending &lt;i&gt;ccmjs&lt;/i&gt; context relevant instances will also not be privatized. * If the first passed property is boolean 'true', than the privatized properties will not be deleted in the passed instance. * @function * @param {Object} instance - instance created from a component * @param {...string|boolean} [keys] - properties that have to privatized * @returns {Object} object that contains the privatized properties and there values * @example * // privatize two public instance members * ccm.component( { * name: 'dummy1', * ccm: ccm, * config: { foo: 'abc', bar: 'xyz', baz: 4711 }, * Instance: function () { * let my; * this.ready = async () =&gt; { * my = ccm.helper.privatize( this, 'foo', 'bar' ); * console.log( my ); // =&gt; { foo: 'abc', bar: 'xyz' } * console.log( my.foo, this.foo ); // =&gt; abc undefined * console.log( my.bar, this.bar ); // =&gt; xyz undefined * console.log( my.baz, this.baz ); // =&gt; undefined 4711 * }; * } * } ); * @example * // privatize all possible public instance members * ccm.component( { * name: 'dummy2', * ccm: ccm, * config: { foo: 'abc', bar: 'xyz', baz: 4711 }, * Instance: function () { * let my; * this.ready = async () =&gt; { * my = ccm.helper.privatize( this ); * console.log( my ); // =&gt; { foo: 'abc', bar: 'xyz', baz: 4711 } * console.log( my.foo, this.foo ); // =&gt; abc undefined * console.log( my.bar, this.bar ); // =&gt; xyz undefined * console.log( my.baz, this.baz ); // =&gt; 4711 undefined * }; * } * } ); * @example * // log all non-ccmjs specific instance members * ccm.component( { * name: 'dummy3', * ccm: ccm, * config: { foo: 'abc', bar: 'xyz', baz: 4711, logger: [ 'ccm.instance', logger_component_url, logger_config ] }, * Instance: function () { * this.ready = async () =&gt; { * this.logger &amp;&amp; this.logger.log( 'ready', $.privatize( this, true ) ); * console.log( this.foo, this.bar, this.foo ); // =&gt; abc xyz 4711 * }; * } * } ); * @memberOf ModuleHelper.Security */ export const privatize = ( instance, ...keys ) =&gt; { let keep = false; if ( keys[ 0 ] === true ) keep = keys.shift(); const obj = {}; if ( keys.length ) keys.forEach( key =&gt; privatizeProperty( key ) ); else for ( const key in instance ) privatizeProperty( key ); return obj; function privatizeProperty( key ) { if ( key === true ) return; switch ( key ) { case 'ccm': case 'component': case 'config': case 'element': case 'id': case 'index': case 'inner': case 'parent': case 'root': case 'shadow': break; default: if ( typeof instance[ key ] === 'function' ) return; if ( instance[ key ] !== undefined ) obj[ key ] = instance[ key ]; if ( !keep ) delete instance[ key ]; } } }; /** * filters script elements out of given HTML * @function * @param {string|Element} html - HTML string or HTML element * @returns {string|Element} cleaned HTML * @example protect( \"Hello &lt;script&gt;alert('XSS');&lt;/script&gt;World!\" ) // =&gt; 'Hello World!' * @example * // &lt;div&gt;Hello &lt;script&gt;alert('XSS');&lt;/script&gt;World!&lt;/div&gt; * div = protect( div ); // =&gt; &lt;div&gt;Hello, World!&lt;/div&gt; * @memberOf ModuleHelper.Security */ export const protect = html =&gt; { if ( typeof html === 'string' ) return html.replace( /&lt;script\\b[^&lt;]*(?:(?!&lt;\\/script&gt;)&lt;[^&lt;]*)*&lt;\\/script&gt;/gi, '' ); if ( ccm.helper.isElement( html ) ) [ ...html.querySelectorAll( 'script' ) ].forEach( remove ); return html; }; √ó Search results Close This Documentation is written by the Developer of ccmjs: Andr√© Kless "},"namespaces.list.html":{"id":"namespaces.list.html","title":"Namespaces","body":" helper.mjs Namespaces ModuleHelperModuleHelper.ActionDataModuleHelper.AsynchronousProgrammingModuleHelper.BackwardsCompatibilityModuleHelper.CheckerModuleHelper.DataHandlingModuleHelper.DataWorkflowModuleHelper.DomManipulationModuleHelper.HandoverAppModuleHelper.InputElementsModuleHelper.OthersModuleHelper.Security Namespaces Namespaces ModuleHelper ActionData AsynchronousProgramming BackwardsCompatibility Checker DataHandling DataWorkflow DomManipulation HandoverApp InputElements Others Security √ó Search results Close This Documentation is written by the Developer of ccmjs: Andr√© Kless "},"index.html":{"id":"index.html","title":"Index","body":" helper.mjs Namespaces ModuleHelperModuleHelper.ActionDataModuleHelper.AsynchronousProgrammingModuleHelper.BackwardsCompatibilityModuleHelper.CheckerModuleHelper.DataHandlingModuleHelper.DataWorkflowModuleHelper.DomManipulationModuleHelper.HandoverAppModuleHelper.InputElementsModuleHelper.OthersModuleHelper.Security Index helper.mjs ES6 module that exports useful help functions for ccmjs component developers. Version: latest (6.0.0) Author: Andr√© Kless &lt;andre.kless@web.de&gt; 2019-2020 License: The MIT License (MIT) Source: helper.mjs, line 1 √ó Search results Close This Documentation is written by the Developer of ccmjs: Andr√© Kless "},"ModuleHelper.html":{"id":"ModuleHelper.html","title":"Namespace: ModuleHelper","body":" helper.mjs Namespaces ModuleHelperModuleHelper.ActionDataModuleHelper.AsynchronousProgrammingModuleHelper.BackwardsCompatibilityModuleHelper.CheckerModuleHelper.DataHandlingModuleHelper.DataWorkflowModuleHelper.DomManipulationModuleHelper.HandoverAppModuleHelper.InputElementsModuleHelper.OthersModuleHelper.Security Namespace: ModuleHelper ModuleHelper (the namespaces are only used for categorization) Source: helper.mjs, line 21 Namespaces ActionData AsynchronousProgramming BackwardsCompatibility Checker DataHandling DataWorkflow DomManipulation HandoverApp InputElements Others Security √ó Search results Close This Documentation is written by the Developer of ccmjs: Andr√© Kless "},"ModuleHelper.ActionData.html":{"id":"ModuleHelper.ActionData.html","title":"Namespace: ActionData","body":" helper.mjs Namespaces ModuleHelperModuleHelper.ActionDataModuleHelper.AsynchronousProgrammingModuleHelper.BackwardsCompatibilityModuleHelper.CheckerModuleHelper.DataHandlingModuleHelper.DataWorkflowModuleHelper.DomManipulationModuleHelper.HandoverAppModuleHelper.InputElementsModuleHelper.OthersModuleHelper.Security Namespace: ActionData ModuleHelper. ActionData help functions for handling action data (predefined function calls) Source: helper.mjs, line 50 Methods &lt;async, static&gt; exports.action(action [, context]) executes action data Parameters: Name Type Argument Description action Array action data context Object &lt;optional&gt; context for this Source: helper.mjs, line 72 Returns: return value of executed action data Type Promise.&lt;*&gt; Examples action( [ functionName, 'param1', 'param2' ] ) action( [ 'functionName', 'param1', 'param2' ] ) action( [ 'this.functionName', 'param1', 'param2' ], context ) action( [ function () { console.log( this ); } ], context ) action( [ 'my.namespace.functionName', 'param1', 'param2' ] ) action( [ [ 'ccm.load', 'moduleURL#functionName' ], 'param1', 'param2' ] ) action( [ functionName ] ) // without parameters action( functionName ) // without array &lt;static&gt; exports.executeByName(name [, args] [, context]) performs a function by function name Parameters: Name Type Argument Description name string function name args Array &lt;optional&gt; function arguments context Object &lt;optional&gt; context for this Source: helper.mjs, line 99 Returns: return value of performed function Type * Examples action( [ 'functionName', 'param1', 'param2' ] ) action( [ 'this.functionName', 'param1', 'param2' ], context ) action( [ 'my.namespace.functionName', 'param1', 'param2' ] ) √ó Search results Close This Documentation is written by the Developer of ccmjs: Andr√© Kless "},"ModuleHelper.AsynchronousProgramming.html":{"id":"ModuleHelper.AsynchronousProgramming.html","title":"Namespace: AsynchronousProgramming","body":" helper.mjs Namespaces ModuleHelperModuleHelper.ActionDataModuleHelper.AsynchronousProgrammingModuleHelper.BackwardsCompatibilityModuleHelper.CheckerModuleHelper.DataHandlingModuleHelper.DataWorkflowModuleHelper.DomManipulationModuleHelper.HandoverAppModuleHelper.InputElementsModuleHelper.OthersModuleHelper.Security Namespace: AsynchronousProgramming ModuleHelper. AsynchronousProgramming help functions for handling asynchronous programming Source: helper.mjs, line 111 Methods &lt;async, static&gt; exports.asyncForEach(array, callback) workaround for an asynchronous foreach Parameters: Name Type Description array Array array to be iterated callback function asynchronous function that is called for each array value Source: helper.mjs, line 131 Returns: Type Promise.&lt;void&gt; Example const waiting_times = [ 100, 200, 300 ]; await asyncForEach( waiting_times, async ( value, i, array ) =&gt; { await sleep( value ); console.log( value, i, array ); } ); &lt;async, static&gt; exports.sleep(time) sleep for a given number of milliseconds Parameters: Name Type Description time number sleep time in milliseconds Source: helper.mjs, line 146 Returns: Type Promise.&lt;void&gt; Examples await sleep( 3000 ); sleep( 3000 ).then( () =&gt; {...} ) ); √ó Search results Close This Documentation is written by the Developer of ccmjs: Andr√© Kless "},"ModuleHelper.BackwardsCompatibility.html":{"id":"ModuleHelper.BackwardsCompatibility.html","title":"Namespace: BackwardsCompatibility","body":" helper.mjs Namespaces ModuleHelperModuleHelper.ActionDataModuleHelper.AsynchronousProgrammingModuleHelper.BackwardsCompatibilityModuleHelper.CheckerModuleHelper.DataHandlingModuleHelper.DataWorkflowModuleHelper.DomManipulationModuleHelper.HandoverAppModuleHelper.InputElementsModuleHelper.OthersModuleHelper.Security Namespace: BackwardsCompatibility ModuleHelper. BackwardsCompatibility help functions for backwards compatibility Source: helper.mjs, line 28 Methods &lt;static&gt; exports.use(version) sets the ccmjs version used by the help functions of this module Parameters: Name Type Description version Object ccmjs version Source: helper.mjs, line 46 √ó Search results Close This Documentation is written by the Developer of ccmjs: Andr√© Kless "},"ModuleHelper.Checker.html":{"id":"ModuleHelper.Checker.html","title":"Namespace: Checker","body":" helper.mjs Namespaces ModuleHelperModuleHelper.ActionDataModuleHelper.AsynchronousProgrammingModuleHelper.BackwardsCompatibilityModuleHelper.CheckerModuleHelper.DataHandlingModuleHelper.DataWorkflowModuleHelper.DomManipulationModuleHelper.HandoverAppModuleHelper.InputElementsModuleHelper.OthersModuleHelper.Security Namespace: Checker ModuleHelper. Checker help functions for condition checks Source: helper.mjs, line 150 Methods &lt;static&gt; exports.hasDomContact(instance) checks if an instance has DOM contact Parameters: Name Type Description instance Object ccmjs-based instance Source: helper.mjs, line 180 Returns: Type boolean Examples // &lt;body&gt;&lt;div id=\"app\"&gt;&lt;/div&gt;&lt;/body&gt; const instance = await ccm.instance( component, { root: document.querySelector( '#app' ) } ); console.log( hasDomContact( instance ) ) ); // =&gt; true const instance = await ccm.instance( component, { root: document.createElement( 'div' ) } ); console.log( hasDomContact( instance ) ) ); // =&gt; false // &lt;body&gt;&lt;div id=\"app\"&gt;&lt;/div&gt;&lt;/body&gt; const parent = await ccm.instance( component, { root: document.querySelector( '#app' ) } ); const instance = await ccm.instance( component, { parent: parent } ); parent.element.appendChild( instance.root ); console.log( hasDomContact( instance ) ) ); // =&gt; true // &lt;body&gt;&lt;div id=\"app\"&gt;&lt;/div&gt;&lt;/body&gt; const parent = await ccm.instance( component, { root: document.querySelector( '#app' ) } ); const instance = await ccm.instance( component, { parent: parent } ); console.log( hasDomContact( instance ) ) ); // =&gt; false &lt;static&gt; exports.hasParentContact(instance) checks if an instance has parent element contact Parameters: Name Type Description instance Object ccmjs-based instance Source: helper.mjs, line 198 Returns: Type boolean Examples const parent = await ccm.instance( component ); const instance = await ccm.instance( component, { parent: parent } ); parent.element.appendChild( instance.root ); console.log( hasParentContact( instance ) ) ); // =&gt; true const parent = await ccm.instance( component ); const instance = await ccm.instance( component, { parent: parent } ); console.log( hasParentContact( instance ) ) ); // =&gt; false &lt;static&gt; exports.isFirefox() checks if current web browser is Firefox Source: helper.mjs, line 206 Returns: Type boolean &lt;static&gt; exports.isGoogleChrome() checks if current web browser is Google Chrome Source: helper.mjs, line 214 Returns: Type boolean &lt;static&gt; exports.isSafari() checks if current web browser is Safari Source: helper.mjs, line 222 Returns: Type boolean √ó Search results Close This Documentation is written by the Developer of ccmjs: Andr√© Kless "},"ModuleHelper.DataHandling.html":{"id":"ModuleHelper.DataHandling.html","title":"Namespace: DataHandling","body":" helper.mjs Namespaces ModuleHelperModuleHelper.ActionDataModuleHelper.AsynchronousProgrammingModuleHelper.BackwardsCompatibilityModuleHelper.CheckerModuleHelper.DataHandlingModuleHelper.DataWorkflowModuleHelper.DomManipulationModuleHelper.HandoverAppModuleHelper.InputElementsModuleHelper.OthersModuleHelper.Security Namespace: DataHandling ModuleHelper. DataHandling help functions for data handling Source: helper.mjs, line 226 Methods &lt;static&gt; exports.arrToObj(arr) converts an array of strings or numbers to an object of booleans Parameters: Name Type Description arr Array.&lt;string&gt; | Array.&lt;number&gt; Source: helper.mjs, line 240 Returns: Type Object.&lt;string, boolean&gt; Examples console.log( arrToObj( [ 'foo', 'bar' ] ) ); // =&gt; { foo: true, bar: true } console.log( arrToObj( [ 1, 2 ] ) ); // =&gt; { 1: true, 2: true } &lt;static&gt; exports.cleanObject(obj [, deep]) cleans an object/array from falsy values Parameters: Name Type Argument Description obj Object | Array deep boolean &lt;optional&gt; deep clean (recursive) Source: helper.mjs, line 256 Returns: cleaned object/array Type Object | Array Example cleanObject( [ 'foo', false, 0, '', null, undefined, [], {} ] ) // =&gt; [ 'foo', [], {} ] &lt;static&gt; exports.decodeJSON(str) decodes with encodeJSON() encoded JSON All %'% are replaced with \". Returns passed parameter if decoding fails. Parameters: Name Type Description str string encoded JSON Source: helper.mjs, line 288 Returns: decoded JSON Type Object | Array | string Examples decodeJSON( \"{%'%log%'%:true,%'%restart%'%:true}\" ) // =&gt; { log: true, restart: true } decodeJSON( \"[%'%ccm.instance%'%,%'%./ccm.user.js%'%]\" ) // =&gt; [ \"ccm.instance\", \"./ccm.user.js\" ] &lt;static&gt; exports.encodeJSON(json) encodes JSON as string so that it can be set as value for input elements All \" are replaced with %'%. Returns passed parameter if encoding fails. Parameters: Name Type Description json Object | Array JSON Source: helper.mjs, line 305 Returns: encoded JSON Type string Examples encodeJSON( { log: true, restart: true } ) // =&gt; \"{%'%log%'%:true,%'%restart%'%:true}\" encodeJSON( [ 'ccm.instance', './ccm.user.js' ] ) // =&gt; \"[%'%ccm.instance%'%,%'%./ccm.user.js%'%]\" &lt;static&gt; exports.escapeHTML(value) escapes HTML characters of a string value Parameters: Name Type Description value string string value Source: helper.mjs, line 318 Returns: Type string Example escapeHTML( 'Hello &lt;b&gt;World&lt;/b&gt;!' ) // =&gt; 'Hello &amp;lt;b&amp;gt;World&amp;lt;/b&amp;gt;!' &lt;static&gt; exports.filterData(data [, mask]) filters a specific subset of complex data Parameters: Name Type Argument Description data Object complex data mask Object &lt;optional&gt; defines specific subset Source: helper.mjs, line 337 Returns: subset of complex data Type Object Examples filterData( { a: 'x', b: 'y', c: 'c' }, { a: true, b: true } ) // =&gt; { a: 'x', b: 'y' } filterData( { a: [ 1, 2, 3 ] }, { 'a.1': true, 'a.2': true } ) // =&gt; { a: [ null, 2, 3 ] } filterData( { a: [ 1, 2, 3 ] }, { a: true, 'a.2': false } ) // =&gt; { a: [ 1, 2, '' ] } filterData( { a: { x: 1, y: 2, z: 3 } }, { 'a.x': true, 'a.y': true } ) // =&gt; { a: { x: 1, y: 2 } } &lt;static&gt; exports.filterProperties(obj [, keys]) filters properties from an object Parameters: Name Type Argument Description obj Object object keys string &lt;optional&gt; &lt;repeatable&gt; properties Source: helper.mjs, line 356 Returns: object that contains only filtered properties Type Object Example filterProperties( { a: 'x', b: 'y', c: 'z' }, 'a', 'b' ) // =&gt; { a: 'x', b: 'y' } &lt;static&gt; exports.renameProperty(obj, before, after) renames the property name of an object Parameters: Name Type Description obj Object the object that contains the property before string old property name after string new property name Source: helper.mjs, line 377 Example const obj = { foo: 4711 }; renameProperty( obj, 'foo', 'bar' ); console.log( obj ); // =&gt; { \"bar\": 4711 } &lt;static&gt; exports.shuffleArray(array) shuffles an array in place with the Fisher-Yates algorithm Parameters: Name Type Description array Array Source: helper.mjs, line 394 See: https://stackoverflow.com/a/6274381 Example const array = [ 1, 2, 3 ]; shuffleArray( array ); console.log( array ); &lt;static&gt; exports.unescapeHTML(value) unescapes HTML characters of a string value Parameters: Name Type Description value string string value Source: helper.mjs, line 409 Returns: Type string Example escapeHTML( 'Hello &amp;lt;b&amp;gt;World&amp;lt;/b&amp;gt;!' ) // =&gt; 'Hello &lt;b&gt;World&lt;/b&gt;!' &lt;static&gt; exports.xml2json(xml) converts a XML document to JSON, attributes of XML elements are ignored Parameters: Name Type Description xml XMLDocument Source: helper.mjs, line 424 Returns: JSON Type Object √ó Search results Close This Documentation is written by the Developer of ccmjs: Andr√© Kless "},"ModuleHelper.DataWorkflow.html":{"id":"ModuleHelper.DataWorkflow.html","title":"Namespace: DataWorkflow","body":" helper.mjs Namespaces ModuleHelperModuleHelper.ActionDataModuleHelper.AsynchronousProgrammingModuleHelper.BackwardsCompatibilityModuleHelper.CheckerModuleHelper.DataHandlingModuleHelper.DataWorkflowModuleHelper.DomManipulationModuleHelper.HandoverAppModuleHelper.InputElementsModuleHelper.OthersModuleHelper.Security Namespace: DataWorkflow ModuleHelper. DataWorkflow help functions for data workflow handling Source: helper.mjs, line 440 Methods &lt;async, static&gt; exports.dataset( [settings]) gets a dataset from a datastore via given settings The original settings given are not changed (they are cloned). If the settings do not contain a dataset key, a unique key is generated. If the dataset does not exist in the datastore, an empty dataset is returned. This dataset is not newly created in the datastore and is only returned locally. Instead of the settings, a dataset can be given directly. This dataset is then returned as result. If the dataset key is specified in the settings directly as the dataset, this dataset is returned as the result. An instance for user authentication that can be reached from the datastore is automatically detected. Parameters: Name Type Argument Default Description settings Object &lt;optional&gt; {} contains the required data to determine the dataset (or is directly the dataset) Properties Name Type Argument Description store Object the datastore that contains the dataset key * &lt;optional&gt; the key of the dataset in the datastore (or initial dataset) login boolean &lt;optional&gt; The user must log in if he is not already logged in to receive the dataset (only if an instance for user authentication could be determined automatically). user boolean &lt;optional&gt; The dataset key given in the settings is expanded to a user-specific key: [ dataset_key, user_key ] (only if user is detected and logged in) permissions Object &lt;optional&gt; If the dataset does not exist, the empty dataset then returned will contain these permission settings. convert function &lt;optional&gt; With this function, the data contained in the result dataset can be adjusted. Source: helper.mjs, line 503 Throws: if user must log in and login is canceled Type Error Returns: Type Promise.&lt;Object&gt; Examples // load dataset by datastore and key const dataset = await dataset( { store: datastore, key: dataset_key } ); console.log( dataset ); // =&gt; { key: dataset_key, ... } // passed dataset is directly returned as the result const dataset = await dataset( { key: dataset_key, ... } ); console.log( dataset ); // =&gt; { key: dataset_key, ... } // passed dataset as key is directly returned as the result const dataset = await dataset( { store: datastore, key: { key: dataset_key, ... } } ); console.log( dataset ); // =&gt; { key: dataset_key, ... } // load of an user-specific dataset const dataset = await dataset( { store: datastore, key: dataset_key, login: true, // user must log in if not already logged in user: true // dataset key and user key will be combined } ); console.log( dataset ); // =&gt; { key: [ dataset_key, user_key ], ... } // get new empty dataset with generated key that contains only given permission settings const dataset = await dataset( { store: datastore, permissions: { creator: 'john', realm: 'guest', access: 'creator' } } ); console.log( dataset ); // =&gt; { key: generated_key, _: { creator: 'john', realm: 'guest', access: 'creator' } } // adaptation of the data structure of the loaded dataset using a convert function const dataset = await dataset( { store: datastore, key: dataset_key, convert: dataset =&gt; { dataset.lang = dataset.lang.toUpperCase(); return dataset; } } ); console.log( dataset ); // =&gt; { key: dataset_key, lang: 'EN', ... } &lt;async, static&gt; exports.onFinish(settings [, results]) allows a declarative way to perform common finish actions The original parameters given are not changed (they are cloned). If an instance is passed for settings, the finish actions defined via the instance.onfinish property are used. If a function is passed for settings, the function is called with the result data. If an instance is passed for settings, the result data are automatically determined via instance.getValue(). To do this, the instance must have a getValue method. If an instance is passed for settings, the nearest instance for user authentication is automatically determined. Parameters: Name Type Argument Description settings Object | function declarative settings for usual finish actions (or 'onfinish' callback or finished instance) results Object &lt;optional&gt; result data of the finished instance settings.confirm string &lt;optional&gt; show confirm box (no finish actions will be performed if user chooses abort) settings.condition function &lt;optional&gt; no finish actions will be performed if this function returns a falsy value (result data and possibly the instance is passed as parameters) settings.login boolean &lt;optional&gt; user will be logged in if not already logged in (only works if an instance for user authentication could be determined) settings.convert function &lt;optional&gt; for dynamic adjustment of the results data (result data is passed as parameter, must return adjusted result data) settings.log boolean &lt;optional&gt; log result data in the developer console of the web browser settings.clear Object &lt;optional&gt; clear webpage area of the finished instance settings.store Object | boolean &lt;optional&gt; use this to store the result data in a data store (use boolean true to apply the settings of instance.data\") Properties Name Type Argument Description settings Object datastore accessor configuration for a datastore (result data will be set in this datastore) key * &lt;optional&gt; dataset key for result data in the datastore (default is generated key) user boolean &lt;optional&gt; The dataset key is expanded to an user-specific key: [ dataset_key, user_key ] (only if instance for user authentication is detected and user is logged in) unique boolean &lt;optional&gt; The dataset key is expanded with an generated unique hash: [ dataset_key, user_key, unique_hash ] permissions Object &lt;optional&gt; If the dataset does not exist, the dataset then will created with these permission settings. settings.alert string &lt;optional&gt; show alert message settings.restart boolean &lt;optional&gt; restart finished instance settings.render Object | * &lt;optional&gt; render other content (ccmjs-based app or HTML content, as default the content is rendered in the root element of the instance) settings.callback callback &lt;optional&gt; additional finish callback which will be called after the other finish actions (result data and possibly the instance is passed as parameter) Source: helper.mjs, line 636 Returns: Type Promise.&lt;void&gt; Examples instance.onfinish = { confirm: 'Are you sure?', condition: ( results, instance ) =&gt; true, login: true, convert: json =&gt; json, log: true, clear: true, store: { settings: { name: 'store_name', url: 'path/to/server/interface.php' }, key: 'dataset_key', user: true, unique: true, permissions: { creator: 'john', group: { john: true, jane: true }, access: { get: 'all', set: 'group', del: 'creator' } } }, alert: 'Finished!', restart: true, render: { component: 'component_url', config: {...} }, callback: ( results, instance ) =&gt; console.log( results, instance ) }; onFinish( instance ); instance.data = { store: { name: 'store_name', url: 'path/to/server/interface.php' } key: 'dataset_key', user: true, unique: true, permissions: {...} }; instance.onfinish = { store: true }; onFinish( instance ); onFinish( { render: { component: 'component_url', config: { root: document.body, ... } } } ); instance.onfinish = { render: 'Hello &lt;b&gt;World&lt;/b&gt;!' }; onFinish( instance ); instance.onfinish = { render: { inner: 'Hello World!' } } }; onFinish( instance ); √ó Search results Close This Documentation is written by the Developer of ccmjs: Andr√© Kless "},"ModuleHelper.DomManipulation.html":{"id":"ModuleHelper.DomManipulation.html","title":"Namespace: DomManipulation","body":" helper.mjs Namespaces ModuleHelperModuleHelper.ActionDataModuleHelper.AsynchronousProgrammingModuleHelper.BackwardsCompatibilityModuleHelper.CheckerModuleHelper.DataHandlingModuleHelper.DataWorkflowModuleHelper.DomManipulationModuleHelper.HandoverAppModuleHelper.InputElementsModuleHelper.OthersModuleHelper.Security Namespace: DomManipulation ModuleHelper. DomManipulation help functions for DOM Manipulation Source: helper.mjs, line 713 Methods &lt;static&gt; exports.append(elem, content) appends content to an HTML element (contained script tags will be removed) Parameters: Name Type Argument Description elem Element HTML element content * &lt;repeatable&gt; Source: helper.mjs, line 731 Examples append( document.body, 'Hello World!' ) append( document.body, 'Hello', ' ', 'World', '!' ) append( document.body, [ 'Hello', ' ', 'World', '!' ] ) append( document.body, [ 'Hello', ' ', [ 'World', '!' ] ] ) append( document.body, { inner: 'Hello World!' } ) append( document.body, 'Hello', [ ' ', [ { inner: 'World' }, '!' ] ] ) &lt;static&gt; exports.prepend(elem, content) prepends content to a HTML element (contained script tags will be removed) Parameters: Name Type Argument Description elem Element HTML element content * &lt;repeatable&gt; Source: helper.mjs, line 764 Examples prepend( document.body, 'Hello World!' ) prepend( document.body, 'Hello', ' ', 'World', '!' ) prepend( document.body, [ 'Hello', ' ', 'World', '!' ] ) prepend( document.body, [ 'Hello', ' ', [ 'World', '!' ] ] ) prepend( document.body, { inner: 'Hello World!' } ) prepend( document.body, 'Hello', [ ' ', [ { inner: 'World' }, '!' ] ] ) &lt;static&gt; exports.remove(elem) removes an HTML element from its parent Parameters: Name Type Description elem Element HTML element Source: helper.mjs, line 799 Example const element = document.createElement( 'div' ); document.body.appendChild( element ); removeElement( element ); console.log( element.parentNode ); // =&gt; null &lt;static&gt; exports.render(content, elem) renders a TemplateResult from lit-html in an HTML element Parameters: Name Type Description content Object TemplateResult from lit-html elem Element HTML element Source: helper.mjs, line 808 &lt;static&gt; exports.replace(elem, other) replaces an HTML element with an other HTML element (contained script tags will be removed) Parameters: Name Type Description elem Element HTML element (must have a parent) other * other HTML element Source: helper.mjs, line 820 Examples replace( document.querySelector( '#myid' ), '&lt;b&gt;World&lt;/b&gt;' ) replace( document.querySelector( '#myid' ), { tag: 'b', inner: 'World' } ) &lt;static&gt; exports.setContent(elem, content) set the content of an HTML element (contained script tags will be removed) Parameters: Name Type Argument Description elem Element HTML element content * &lt;repeatable&gt; new content for the HTML element (old content is cleared) Source: helper.mjs, line 835 Examples setContent( document.body, 'Hello World!' ) setContent( document.body, 'Hello', ' ', 'World', '!' ) setContent( document.body, [ 'Hello', ' ', 'World', '!' ] ) setContent( document.body, [ 'Hello', ' ', [ 'World', '!' ] ] ) setContent( document.body, { inner: 'Hello World!' } ) setContent( document.body, 'Hello', [ ' ', [ { inner: 'World' }, '!' ] ] ) √ó Search results Close This Documentation is written by the Developer of ccmjs: Andr√© Kless "},"ModuleHelper.HandoverApp.html":{"id":"ModuleHelper.HandoverApp.html","title":"Namespace: HandoverApp","body":" helper.mjs Namespaces ModuleHelperModuleHelper.ActionDataModuleHelper.AsynchronousProgrammingModuleHelper.BackwardsCompatibilityModuleHelper.CheckerModuleHelper.DataHandlingModuleHelper.DataWorkflowModuleHelper.DomManipulationModuleHelper.HandoverAppModuleHelper.InputElementsModuleHelper.OthersModuleHelper.Security Namespace: HandoverApp ModuleHelper. HandoverApp helper functions for handover of an app Source: helper.mjs, line 1049 Methods &lt;static&gt; exports.appURL(component [, config] [, url]) returns the URL of a ccmjs-based app The entire instance configuration is included in the app URL. If the instance configuration is in a datastore, it can also be linked via a data dependency instead. For this purpose, an object with the datastore accessor configuration and the dataset key must be passed instead of the instance configuration. Instead of a datastore accessor configuration an already created datastore accessor could also be passed. Parameters: Name Type Argument Default Description component string URL of the component on which the app is based. config Object &lt;optional&gt; {} configuration for the instance that is created from the component to build the app. url string &lt;optional&gt; \"https://ccmjs.github.io/digital-maker-space/app.html\" URL of the webpage which shows the app Source: helper.mjs, line 1080 Returns: Type string Examples // with default configuration appURL( 'https://ccmjs.github.io/akless-components/blank/ccm.blank.js' ) // https://ccmjs.github.io/digital-maker-space/app.html#component=https://ccmjs.github.io/akless-components/blank/ccm.blank.js&amp;config={} // with individual configuration appURL( 'https://ccmjs.github.io/akless-components/multi_blank/ccm.multi_blank.js', { times: 5 } ) // https://ccmjs.github.io/digital-maker-space/app.html#component=https://ccmjs.github.io/akless-components/multi_blank/ccm.multi_blank.js&amp;config={\"times\":5} // with individual configuration that is stored in a datastore appURL( 'https://ccmjs.github.io/akless-components/cloze/versions/ccm.cloze-6.0.3.js', { store: 'https://ccmjs.github.io/akless-components/cloze/resources/configs.js', key: 'demo' } ) // https://ccmjs.github.io/digital-maker-space/app.html#component=https://ccmjs.github.io/akless-components/cloze/versions/ccm.cloze-6.0.3.js&amp;config={\"store\":\"https://ccmjs.github.io/akless-components/cloze/resources/configs.js\",\"key\":\"demo\"} // pass an already created datastore instead of a datastore accessor configuration appURL( 'https://ccmjs.github.io/akless-components/cloze/versions/ccm.cloze-6.0.3.js', { store: await ccm.store( { name: 'cloze', url: 'https://ccm2.inf.h-brs.de' } ), key: 'demo' } ) // https://ccmjs.github.io/digital-maker-space/app.html#component=https://ccmjs.github.io/akless-components/cloze/versions/ccm.cloze-6.0.3.js&amp;config={\"store\":{\"name\":\"cloze\",\"url\":\"https://ccm2.inf.h-brs.de\"},\"key\":\"demo\"} &lt;static&gt; exports.decomposeAppURL(app_url) decomposes a given app URL of a ccmjs-based app into component URL and instance configuration Parameters: Name Type Description app_url string URL of the app Source: helper.mjs, line 1101 Returns: Type Object Examples decomposeAppURL( 'https://ccmjs.github.io/digital-maker-space/app.html#component=https://ccmjs.github.io/akless-components/blank/ccm.blank.js&amp;config={}' ) // { component: 'https://ccmjs.github.io/akless-components/blank/ccm.blank.js' } decomposeAppURL( 'https://ccmjs.github.io/digital-maker-space/app.html#component=https://ccmjs.github.io/akless-components/multi_blank/ccm.multi_blank.js&amp;config={\"times\":5}' ) // { component: 'https://ccmjs.github.io/akless-components/multi_blank/ccm.multi_blank.js', config: { times: 5 } } decomposeAppURL( 'https://ccmjs.github.io/digital-maker-space/app.html#component=https://ccmjs.github.io/akless-components/cloze/versions/ccm.cloze-6.0.3.js&amp;config={\"store\":\"https://ccmjs.github.io/akless-components/cloze/resources/configs.js\",\"key\":\"demo\"}' ) // { component: 'https://ccmjs.github.io/akless-components/cloze/versions/ccm.cloze-6.0.3.js', config: { store: 'https://ccmjs.github.io/akless-components/cloze/resources/configs.js', key: 'demo' } } &lt;static&gt; exports.decomposeEmbedCode(embed_code) decomposes a given embed code of a ccmjs-based app into component URL and instance configuration Parameters: Name Type Description embed_code string embed code of the app Source: helper.mjs, line 1144 Returns: Type Object Examples decomposeEmbedCode( `&lt;script src='https://ccmjs.github.io/akless-components/blank/ccm.blank.js'&gt;&lt;/script&gt;&lt;ccm-blank key='{}'&gt;&lt;/ccm-blank&gt;` ) // { component: 'https://ccmjs.github.io/akless-components/blank/ccm.blank.js' } decomposeEmbedCode( `&lt;script src='https://ccmjs.github.io/akless-components/multi_blank/ccm.multi_blank.js'&gt;&lt;/script&gt;&lt;ccm-multi_blank key='{\"times\":5}'&gt;&lt;/ccm-multi_blank&gt;` ) // { component: 'https://ccmjs.github.io/akless-components/multi_blank/ccm.multi_blank.js', config: { times: 5 } } decomposeEmbedCode( `&lt;script src='https://ccmjs.github.io/akless-components/cloze/versions/ccm.cloze-6.0.3.js'&gt;&lt;/script&gt;&lt;ccm-cloze-6-0-3 key='[\"ccm.get\",\"https://ccmjs.github.io/akless-components/cloze/resources/configs.js\",\"demo\"]'&gt;&lt;/ccm-cloze-6-0-3&gt;` ) // { component: 'https://ccmjs.github.io/akless-components/cloze/versions/ccm.cloze-6.0.3.js', config: { store: 'https://ccmjs.github.io/akless-components/cloze/resources/configs.js', key: 'demo' } } decomposeEmbedCode( `&lt;ccm-app component='https://ccmjs.github.io/akless-components/blank/ccm.blank.js' key='{}'&gt;&lt;/ccm-app&gt;` ) // { component: 'https://ccmjs.github.io/akless-components/blank/ccm.blank.js' } decomposeEmbedCode( `&lt;ccm-app component='https://ccmjs.github.io/akless-components/multi_blank/ccm.multi_blank.js' key='{\"times\":5}'&gt;&lt;/ccm-app&gt;` ) // { component: 'https://ccmjs.github.io/akless-components/multi_blank/ccm.multi_blank.js', config: { times: 5 } } decomposeEmbedCode( `&lt;ccm-app component='https://ccmjs.github.io/akless-components/cloze/versions/ccm.cloze-6.0.3.js' key='[\"ccm.get\",\"https://ccmjs.github.io/akless-components/cloze/resources/configs.js\",\"demo\"]'&gt;&lt;/ccm-app&gt;` ) // { component: 'https://ccmjs.github.io/akless-components/cloze/versions/ccm.cloze-6.0.3.js', config: { store: 'https://ccmjs.github.io/akless-components/cloze/resources/configs.js', key: 'demo' } } &lt;static&gt; exports.downloadApp(embed_code [, filename] [, title] [, template]) provides a download of a ccmja-based app as HTML file Parameters: Name Type Argument Default Description embed_code string embed code (with included script tag) of the app filename string &lt;optional&gt; 'app' filename without file extension title string &lt;optional&gt; 'App' title of the webpage template string &lt;optional&gt; 'https://ccmjs.github.io/akless-components/resources/templates/app.html' URL of the HTML template file Source: helper.mjs, line 1178 Returns: Type Promise.&lt;void&gt; Example const embed_code = \"&lt;script src='https://ccmjs.github.io/akless-components/blank/ccm.blank.js'&gt;&lt;/sc\"+\"ript&gt;&lt;ccm-blank key='{}'&gt;&lt;/ccm-blank&gt;\"; downloadApp( embed_code, 'blank', 'Blank App' ); &lt;static&gt; exports.embedCode(component [, config] [, noscript]) generates the HTML embed code of a ccmjs-based app The entire instance configuration is included in the embed code. If the instance configuration is in a datastore, it can also be linked via a data dependency instead. For this purpose, an object with the datastore accessor configuration and the dataset key must be passed instead of the instance configuration. Instead of a datastore accessor configuration an already created datastore accessor could also be passed. If the embed code does not contain a script tag, it will only work if a ccmjs version is already present in the webpage. Parameters: Name Type Argument Default Description component string URL of the component on which the app is based. config Object &lt;optional&gt; {} configuration for the instance that is created from the component to build the app. noscript boolean &lt;optional&gt; embed code does not contain a script tag Source: helper.mjs, line 1225 Returns: generated embed code Type string Examples // with default configuration embedCode( 'https://ccmjs.github.io/akless-components/blank/ccm.blank.js' ) // &lt;script src='https://ccmjs.github.io/akless-components/blank/ccm.blank.js'&gt;&lt;/script&gt;&lt;ccm-blank key='{}'&gt;&lt;/ccm-blank&gt; // with individual configuration embedCode( 'https://ccmjs.github.io/akless-components/multi_blank/ccm.multi_blank.js', { times: 5 } ) // &lt;script src='https://ccmjs.github.io/akless-components/multi_blank/ccm.multi_blank.js'&gt;&lt;/script&gt;&lt;ccm-multi_blank key='{\"times\":5}'&gt;&lt;/ccm-multi_blank&gt; // with individual configuration that is stored in a datastore embedCode( embedCode( 'https://ccmjs.github.io/akless-components/cloze/versions/ccm.cloze-6.0.3.js', { store: 'https://ccmjs.github.io/akless-components/cloze/resources/configs.js', key: 'demo' } ) ) // &lt;script src='https://ccmjs.github.io/akless-components/cloze/versions/ccm.cloze-6.0.3.js'&gt;&lt;/script&gt;&lt;ccm-cloze-6-0-3 key='[\"ccm.get\",\"https://ccmjs.github.io/akless-components/cloze/resources/configs.js\",\"demo\"]'&gt;&lt;/ccm-cloze-6-0-3&gt; // pass an already created datastore accessor instead of a datastore accessor configuration embedCode( 'https://ccmjs.github.io/akless-components/cloze/versions/ccm.cloze-6.0.3.js', { store: await ccm.store( { name: 'cloze', url: 'https://ccm2.inf.h-brs.de' } ), key: 'demo' } ) // &lt;script src='https://ccmjs.github.io/akless-components/cloze/versions/ccm.cloze-6.0.3.js'&gt;&lt;/script&gt;&lt;ccm-cloze-6-0-3 key='[\"ccm.get\",{\"name\":\"cloze\",\"url\":\"https://ccm2.inf.h-brs.de\"},\"demo\"]'&gt;&lt;/ccm-cloze-6-0-3&gt; // with no script tag and default configuration embedCode( 'https://ccmjs.github.io/akless-components/blank/ccm.blank.js', undefined, true ) // &lt;ccm-app component='https://ccmjs.github.io/akless-components/blank/ccm.blank.js' key='{}'&gt;&lt;/ccm-app&gt; // with no script tag and individual configuration embedCode( 'https://ccmjs.github.io/akless-components/multi_blank/ccm.multi_blank.js', { times: 5 }, true ) // &lt;ccm-app component='https://ccmjs.github.io/akless-components/multi_blank/ccm.multi_blank.js' key='{\"times\":5}'&gt;&lt;/ccm-app&gt; // with no script tag and individual configuration that is stored in a datastore embedCode( 'https://ccmjs.github.io/akless-components/cloze/versions/ccm.cloze-6.0.3.js', { store: 'https://ccmjs.github.io/akless-components/cloze/resources/configs.js', key: 'demo' }, true ) // &lt;ccm-app component='https://ccmjs.github.io/akless-components/cloze/versions/ccm.cloze-6.0.3.js' key='[\"ccm.get\",\"https://ccmjs.github.io/akless-components/cloze/resources/configs.js\",\"demo\"]'&gt;&lt;/ccm-app&gt; // with no script tag and an already created datastore accessor is passed instead of a datastore accessor configuration embedCode( 'https://ccmjs.github.io/akless-components/cloze/versions/ccm.cloze-6.0.3.js', { store: await ccm.store( { name: 'cloze', url: 'https://ccm2.inf.h-brs.de' } ), key: 'demo' }, true ) // &lt;ccm-app component='https://ccmjs.github.io/akless-components/cloze/versions/ccm.cloze-6.0.3.js' key='[\"ccm.get\",{\"name\":\"cloze\",\"url\":\"https://ccm2.inf.h-brs.de\"},\"demo\"]'&gt;&lt;/ccm-app&gt; &lt;async, static&gt; exports.iBookWidget(embed_code [, filename] [, title] [, folder] [, template] [, info_file] [, image_file]) provides a download of a ccmjs-based app as iBook Widget (ZIP file) Parameters: Name Type Argument Default Description embed_code string embed code (with included script tag) of the app filename string &lt;optional&gt; 'app' filename without file extension title string &lt;optional&gt; 'App' website title for the index.html folder string &lt;optional&gt; 'app' name of the folder inside the iBook Widget template string &lt;optional&gt; 'https://ccmjs.github.io/akless-components/resources/templates/app.html' URL of the HTML template info_file string &lt;optional&gt; 'https://ccmjs.github.io/akless-components/resources/templates/ibook_widget/Info.plist' URL of the info file image_file string &lt;optional&gt; 'https://ccmjs.github.io/akless-components/resources/templates/ibook_widget/Default.png' URL of the image file Source: helper.mjs, line 1259 Returns: Type Promise.&lt;void&gt; Example const embed_code = \"&lt;script src='https://ccmjs.github.io/akless-components/blank/ccm.blank.js'&gt;&lt;/sc\"+\"ript&gt;&lt;ccm-blank key='{}'&gt;&lt;/ccm-blank&gt;\"; iBookWidget( embed_code, 'blank', 'Blank App', 'blank_app' ); &lt;async, static&gt; exports.scorm(embed_code [, filename] [, title] [, identifier] [, html_template] [, manifest_template] [, api_file]) provides a download of a ccmjs-based app as SCORM package (ZIP file) Parameters: Name Type Argument Default Description embed_code string embed code (with included script tag) of the app filename string &lt;optional&gt; 'app' filename without file extension title string &lt;optional&gt; 'App' website title within the manifest identifier string &lt;optional&gt; 'App' identifier within the manifest html_template string &lt;optional&gt; 'https://ccmjs.github.io/akless-components/resources/templates/scorm/index.html' URL of HTML template manifest_template string &lt;optional&gt; 'https://ccmjs.github.io/akless-components/resources/templates/scorm/imsmanifest.xml' URL of manifest template api_file string &lt;optional&gt; 'https://ccmjs.github.io/akless-components/resources/templates/scorm/SCORM_API_wrapper.js' URL of SCORM API file Source: helper.mjs, line 1301 Returns: Type Promise.&lt;void&gt; Example const embed_code = \"&lt;script src='https://ccmjs.github.io/akless-components/blank/ccm.blank.js'&gt;&lt;/sc\"+\"ript&gt;&lt;ccm-blank key='{}'&gt;&lt;/ccm-blank&gt;\"; scorm( embed_code, 'blank', 'Blank App', 'blank_app' ); √ó Search results Close This Documentation is written by the Developer of ccmjs: Andr√© Kless "},"ModuleHelper.InputElements.html":{"id":"ModuleHelper.InputElements.html","title":"Namespace: InputElements","body":" helper.mjs Namespaces ModuleHelperModuleHelper.ActionDataModuleHelper.AsynchronousProgrammingModuleHelper.BackwardsCompatibilityModuleHelper.CheckerModuleHelper.DataHandlingModuleHelper.DataWorkflowModuleHelper.DomManipulationModuleHelper.HandoverAppModuleHelper.InputElementsModuleHelper.OthersModuleHelper.Security Namespace: InputElements ModuleHelper. InputElements helper functions for handling of HTML input elements Source: helper.mjs, line 842 Methods &lt;static&gt; exports.fillForm(elem, data) fills input elements with values Parameters: Name Type Description elem Element HTML element which contains the input elements (must not be an HTML form tag) data Object contains the values for the input elements Source: helper.mjs, line 902 Examples // &lt;body&gt;&lt;input type=\"text\" name=\"user\"&gt;&lt;input type=\"password\" name=\"secret\"&gt;&lt;/body&gt; fillForm( document.body, { user: 'JohnDoe', secret: '1aA' } ); console.log( formData( document.body ) ); // { user: 'JohnDoe', secret: '1aA' } // &lt;body&gt;&lt;input type=\"checkbox\" name=\"agreed\"&gt;&lt;/body&gt; (boolean checkbox) fillForm( document.body, { agreed: true } ); console.log( formData( document.body ) ); // { agreed: true } // &lt;body&gt;&lt;input type=\"checkbox\" name=\"role\" value=\"Coordinator\"&gt;&lt;/body&gt; (value checkbox) fillForm( document.body, { role: 'Coordinator' } ); console.log( formData( document.body ) ); // { role: 'Coordinator' } // &lt;body&gt;&lt;input type=\"checkbox\" name=\"types\" value=\"A\"&gt;&lt;input type=\"checkbox\" name=\"types\" value=\"B\"&gt;&lt;/body&gt; (multi checkbox) fillForm( document.body, { types: [ 'A', 'B' ] } ); console.log( formData( document.body ) ); // { types: [ 'A', 'B' ] } // &lt;body&gt;&lt;input type=\"radio\" name=\"choice\" value=\"A\"&gt;&lt;input type=\"radio\" name=\"choice\" value=\"B\"&gt;&lt;/body&gt; (radio buttons) fillForm( document.body, { choice: 'A' } ); console.log( formData( document.body ) ); // { choice: 'A' } // &lt;body&gt;&lt;select name=\"item\"&gt;&lt;option value=\"A\"&gt;Item A&lt;/option&gt;&lt;option value=\"B\"&gt;Item B&lt;/option&gt;&lt;/select&gt;&lt;/body&gt; (selector box) fillForm( document.body, { item: 'A' } ); console.log( formData( document.body ) ); // { item: 'A' } // &lt;body&gt;&lt;select name=\"item\"&gt;&lt;option&gt;A&lt;/option&gt;&lt;option&gt;B&lt;/option&gt;&lt;/select&gt;&lt;/body&gt; (selector box without values) fillForm( document.body, { item: 'A' } ); console.log( formData( document.body ) ); // { item: 'A' } // &lt;body&gt;&lt;select multiple name=\"items\"&gt;&lt;option value=\"A\"&gt;Item A&lt;/option&gt;&lt;option value=\"B\"&gt;Item B&lt;/option&gt;&lt;/select&gt;&lt;/body&gt; (multi-selector box) fillForm( document.body, { items: [ 'A', 'B' ] } ); console.log( formData( document.body ) ); // { items: [ 'A', 'B' ] } // &lt;body&gt;&lt;textarea name=\"description\"&gt;&lt;/description&gt;&lt;/body&gt; (textarea) fillForm( document.body, { description: 'Hello World!' } ); console.log( formData( document.body ) ); // { description: 'Hello World!' } // &lt;body&gt;&lt;div contenteditable name=\"topic\"&gt;&lt;/div&gt;&lt;/body&gt; (in-place editing with contenteditable) fillForm( document.body, { topic: 'Hello World!' } ); console.log( formData( document.body ) ); // { topic: 'Hello World!' } // &lt;body&gt;&lt;input type=\"text\" name=\"deep.property.key\"&gt;&lt;/input&gt;&lt;/body&gt; (deep property value) fillForm( document.body, { 'deep.property.key': 'value' } ); console.log( formData( document.body ) ); // { deep: { property: { key: 'value' } } } // &lt;body&gt;&lt;input type=\"text\" name=\"data\"&gt;&lt;/input&gt;&lt;/body&gt; (complex data value) fillForm( document.body, { data: { number: [ 1, 2, { a: 3 } ], checked: true, value: 'Hello World!' } } ); console.log( formData( document.body ) ); // { data: { number: [ 1, 2, { a: 3 } ], checked: true, value: 'Hello World!' } } &lt;static&gt; exports.formData(elem [, settings]) gets the values of input elements Parameters: Name Type Argument Default Description elem Element HTML element which contains the input elements (must not be a HTML form tag) settings Object &lt;optional&gt; {} optional additional settings Properties Name Type Argument Description enabled_only boolean &lt;optional&gt; ignore values from disabled input elements Source: helper.mjs, line 1003 Returns: values of the input elements Type Object Examples // &lt;body&gt;&lt;input type=\"text\" name=\"user\"&gt;&lt;input type=\"password\" name=\"secret\"&gt;&lt;/body&gt; fillForm( document.body, { user: 'JohnDoe', secret: '1aA' } ); console.log( formData( document.body ) ); // { user: 'JohnDoe', secret: '1aA' } // &lt;body&gt;&lt;input type=\"checkbox\" name=\"agreed\"&gt;&lt;/body&gt; (boolean checkbox) fillForm( document.body, { agreed: true } ); console.log( formData( document.body ) ); // { agreed: true } // &lt;body&gt;&lt;input type=\"checkbox\" name=\"role\" value=\"Coordinator\"&gt;&lt;/body&gt; (value checkbox) fillForm( document.body, { role: 'Coordinator' } ); console.log( formData( document.body ) ); // { role: 'Coordinator' } // &lt;body&gt;&lt;input type=\"checkbox\" name=\"types\" value=\"A\"&gt;&lt;input type=\"checkbox\" name=\"types\" value=\"B\"&gt;&lt;/body&gt; (multi checkbox) fillForm( document.body, { types: [ 'A', 'B' ] } ); console.log( formData( document.body ) ); // { types: [ 'A', 'B' ] } // &lt;body&gt;&lt;input type=\"radio\" name=\"choice\" value=\"A\"&gt;&lt;input type=\"radio\" name=\"choice\" value=\"B\"&gt;&lt;/body&gt; (radio buttons) fillForm( document.body, { choice: 'A' } ); console.log( formData( document.body ) ); // { choice: 'A' } // &lt;body&gt;&lt;select name=\"item\"&gt;&lt;option value=\"A\"&gt;Item A&lt;/option&gt;&lt;option value=\"B\"&gt;Item B&lt;/option&gt;&lt;/select&gt;&lt;/body&gt; (selector box) fillForm( document.body, { item: 'A' } ); console.log( formData( document.body ) ); // { item: 'A' } // &lt;body&gt;&lt;select name=\"item\"&gt;&lt;option&gt;A&lt;/option&gt;&lt;option&gt;B&lt;/option&gt;&lt;/select&gt;&lt;/body&gt; (selector box without values) fillForm( document.body, { item: 'A' } ); console.log( formData( document.body ) ); // { item: 'A' } // &lt;body&gt;&lt;select multiple name=\"items\"&gt;&lt;option value=\"A\"&gt;Item A&lt;/option&gt;&lt;option value=\"B\"&gt;Item B&lt;/option&gt;&lt;/select&gt;&lt;/body&gt; (multi-selector box) fillForm( document.body, { items: [ 'A', 'B' ] } ); console.log( formData( document.body ) ); // { items: [ 'A', 'B' ] } // &lt;body&gt;&lt;textarea name=\"description\"&gt;&lt;/description&gt;&lt;/body&gt; (textarea) fillForm( document.body, { description: 'Hello World!' } ); console.log( formData( document.body ) ); // { description: 'Hello World!' } // &lt;body&gt;&lt;div contenteditable name=\"topic\"&gt;&lt;/div&gt;&lt;/body&gt; (in-place editing with contenteditable) fillForm( document.body, { topic: 'Hello World!' } ); console.log( formData( document.body ) ); // { topic: 'Hello World!' } // &lt;body&gt;&lt;input type=\"text\" name=\"deep.property.key\"&gt;&lt;/input&gt;&lt;/body&gt; (deep property value) fillForm( document.body, { 'deep.property.key': 'value' } ); console.log( formData( document.body ) ); // { deep: { property: { key: 'value' } } } // &lt;body&gt;&lt;input type=\"text\" name=\"data\"&gt;&lt;/input&gt;&lt;/body&gt; (complex data value) fillForm( document.body, { data: { number: [ 1, 2, { a: 3 } ], checked: true, value: 'Hello World!' } } ); console.log( formData( document.body ) ); // { data: { number: [ 1, 2, { a: 3 } ], checked: true, value: 'Hello World!' } } // &lt;body&gt;&lt;input type=\"text\" name=\"user\"&gt;&lt;input type=\"password\" name=\"secret\" disabled&gt;&lt;/body&gt; fillForm( document.body, { user: 'JohnDoe', secret: '1aA' } ); console.log( formData( document.body, { enabled_only: true } ) ); // { user: 'JohnDoe' } √ó Search results Close This Documentation is written by the Developer of ccmjs: Andr√© Kless "},"ModuleHelper.Others.html":{"id":"ModuleHelper.Others.html","title":"Namespace: Others","body":" helper.mjs Namespaces ModuleHelperModuleHelper.ActionDataModuleHelper.AsynchronousProgrammingModuleHelper.BackwardsCompatibilityModuleHelper.CheckerModuleHelper.DataHandlingModuleHelper.DataWorkflowModuleHelper.DomManipulationModuleHelper.HandoverAppModuleHelper.InputElementsModuleHelper.OthersModuleHelper.Security Namespace: Others ModuleHelper. Others not categorizable helper functions Source: helper.mjs, line 1329 Methods &lt;static&gt; exports.copyToClipboard(elem) copies text inside an HTML element to clipboard Parameters: Name Type Description elem Element HTML element Source: helper.mjs, line 1344 Example // &lt;body&gt;&lt;input type=\"text\" value=\"Hello World!\"&gt;&lt;/body&gt; copyToClipboard( document.body.querySelector( 'input' ) ) // STRG+V then pastes 'Hello, World!' from clipboard &lt;static&gt; exports.download(filename, content [, mime]) provides a download of an on-the-fly created file Parameters: Name Type Argument Default Description filename string filename including file extension content string content of the file mime string &lt;optional&gt; 'text/html;charset=utf-8' media type followed by charset or 'base64' if non-textual Source: helper.mjs, line 1358 Example download( 'hello_world.html', '&lt;!DOCTYPE html&gt;&lt;meta charset=\"utf-8\"&gt;Hello World!' ) &lt;static&gt; exports.fullscreen(elem) shows the content of a webpage area in fullscreen mode Parameters: Name Type Description elem Element webpage area Source: helper.mjs, line 1379 Example // &lt;body&gt;&lt;div id=\"app\"&gt;Hello World!&lt;/div&gt;&lt;/body&gt; fullscreen( document.body.querySelector( '#app' ) ) &lt;async, static&gt; exports.loadScript(url) executes the included code of a JavaScript file Parameters: Name Type Description url string URL of the JavaScript file Source: helper.mjs, line 1402 Returns: Type Promise.&lt;void&gt; Examples await loadScript( 'https://ccmjs.github.io/akless-components/libs/jszip/jszip.min.js' ) await loadScript( 'https://ccmjs.github.io/akless-components/libs/FileSaver/FileSaver.js' ) &lt;static&gt; exports.progressBar(elem [, actual] [, total]) appends a progress bar to a DOM element Parameters: Name Type Argument Default Description elem Element progress bar will be appended to this element actual number &lt;optional&gt; 0 actual points total number &lt;optional&gt; 100 maximum points Source: helper.mjs, line 1423 Examples progressBar( document.body, 60 ) progressBar( document.body, 40, 120 ) √ó Search results Close This Documentation is written by the Developer of ccmjs: Andr√© Kless "},"ModuleHelper.Security.html":{"id":"ModuleHelper.Security.html","title":"Namespace: Security","body":" helper.mjs Namespaces ModuleHelperModuleHelper.ActionDataModuleHelper.AsynchronousProgrammingModuleHelper.BackwardsCompatibilityModuleHelper.CheckerModuleHelper.DataHandlingModuleHelper.DataWorkflowModuleHelper.DomManipulationModuleHelper.HandoverAppModuleHelper.InputElementsModuleHelper.OthersModuleHelper.Security Namespace: Security ModuleHelper. Security helper functions for security handling Source: helper.mjs, line 1449 Methods &lt;static&gt; exports.hasPermission( [settings] [, user], operation) checks user permissions A dataset without permission settings is public data =&gt; access granted. Time-dependent permissions are not checked on client-side =&gt; access granted. The realm of user and of the permission settings must be the same. The creator has always all access right =&gt; access granted. Parameters: Name Type Argument Description settings Object &lt;optional&gt; permission settings or dataset with contained permission settings user Object &lt;optional&gt; user data or user instance that holds the user data operation string data operation that has to check: \"get\" (read), \"set\" (update) or \"del\" (delete) Source: helper.mjs, line 1493 Returns: true: access granted, false: access denied Type boolean Examples const settings = { creator: 'john', realm: 'guest', access: 'all' }; const user = { key: 'jane', realm: 'guest' }; hasPermission( settings, user, 'get' ); // =&gt; true: access granted const dataset = { _: { creator: 'john', realm: 'guest', group: [ 'john', 'jane' ], access: { get: 'all', set: 'group', del: 'creator' } } }; const user = { key: 'jane', realm: 'guest' }; hasPermission( dataset, user, 'set' ); // =&gt; true: access granted const dataset = { _: { creator: 'john', realm: 'guest', group: { students: [ 'john', 'jane' ], teachers: [ 'jake' ] }, access: { get: 'all', set: 'students,teachers', del: 'teachers' } } }; const user = { key: 'jane', realm: 'guest' }; hasPermission( dataset, user, 'del' ); // =&gt; false: access denied &lt;static&gt; exports.isCreator(dataset, user) checks if a user is the creator of a dataset Parameters: Name Type Description dataset Object dataset with contained permission settings user Object user data or user instance that holds the user data Source: helper.mjs, line 1536 Returns: Type boolean Example const dataset = { _: { creator: 'john', realm: 'guest', access: 'all' } }; const user = { key: 'john', realm: 'guest' }; isCreator( dataset, user ); // =&gt; true &lt;static&gt; exports.privatize(instance [, keys]) privatizes public members of an instance Deletes all given properties in an object and returns another object with the deleted properties and there values. If no properties are given, then all not ccmjs relevant instance members will be privatized. List of ccmjs relevant properties that will not be privatized: ccm component config element id index inner parent root shadow In addition to this: All functions and depending ccmjs context relevant instances will also not be privatized. If the first passed property is boolean 'true', than the privatized properties will not be deleted in the passed instance. Parameters: Name Type Argument Description instance Object instance created from a component keys string | boolean &lt;optional&gt; properties that have to privatized Source: helper.mjs, line 1614 Returns: object that contains the privatized properties and there values Type Object Examples // privatize two public instance members ccm.component( { name: 'dummy1', ccm: ccm, config: { foo: 'abc', bar: 'xyz', baz: 4711 }, Instance: function () { let my; this.ready = async () =&gt; { my = ccm.helper.privatize( this, 'foo', 'bar' ); console.log( my ); // =&gt; { foo: 'abc', bar: 'xyz' } console.log( my.foo, this.foo ); // =&gt; abc undefined console.log( my.bar, this.bar ); // =&gt; xyz undefined console.log( my.baz, this.baz ); // =&gt; undefined 4711 }; } } ); // privatize all possible public instance members ccm.component( { name: 'dummy2', ccm: ccm, config: { foo: 'abc', bar: 'xyz', baz: 4711 }, Instance: function () { let my; this.ready = async () =&gt; { my = ccm.helper.privatize( this ); console.log( my ); // =&gt; { foo: 'abc', bar: 'xyz', baz: 4711 } console.log( my.foo, this.foo ); // =&gt; abc undefined console.log( my.bar, this.bar ); // =&gt; xyz undefined console.log( my.baz, this.baz ); // =&gt; 4711 undefined }; } } ); // log all non-ccmjs specific instance members ccm.component( { name: 'dummy3', ccm: ccm, config: { foo: 'abc', bar: 'xyz', baz: 4711, logger: [ 'ccm.instance', logger_component_url, logger_config ] }, Instance: function () { this.ready = async () =&gt; { this.logger &amp;&amp; this.logger.log( 'ready', $.privatize( this, true ) ); console.log( this.foo, this.bar, this.foo ); // =&gt; abc xyz 4711 }; } } ); &lt;static&gt; exports.protect(html) filters script elements out of given HTML Parameters: Name Type Description html string | Element HTML string or HTML element Source: helper.mjs, line 1660 Returns: cleaned HTML Type string | Element Examples protect( \"Hello &lt;script&gt;alert('XSS');&lt;/script&gt;World!\" ) // =&gt; 'Hello World!' // &lt;div&gt;Hello &lt;script&gt;alert('XSS');&lt;/script&gt;World!&lt;/div&gt; div = protect( div ); // =&gt; &lt;div&gt;Hello, World!&lt;/div&gt; √ó Search results Close This Documentation is written by the Developer of ccmjs: Andr√© Kless "}}
    </script>

    <script type="text/javascript">
        $(document).ready(function() {
            Searcher.init();
        });

        $(window).on("message", function(msg) {
            var msgData = msg.originalEvent.data;

            if (msgData.msgid != "docstrap.quicksearch.start") {
                return;
            }

            var results = Searcher.search(msgData.searchTerms);

            window.parent.postMessage({"results": results, "msgid": "docstrap.quicksearch.done"}, "*");
        });
    </script>
</body>
</html>
