(function(){const component={name:"kanban_card",version:[2,0,0],ccm:"https://ccmjs.github.io/ccm/versions/ccm-18.2.0.js",config:{html:{id:"main",inner:[{id:"header",inner:[{id:"title",class:"entry",inner:[{class:"value",inner:"%title%",contenteditable:"%editable%",oninput:"%oninput_title%",onblur:"%onblur_title%"}]},{id:"owner",class:"entry",inner:[{class:"value",inner:"%owner%",contenteditable:"%editable%",onfocus:"%onfocus_owner%"},{inner:{tag:"img",src:"%icon_owner%"}}]}]},{id:"body",inner:{id:"summary",class:"entry",inner:{class:"value",inner:"%summary%",contenteditable:"%editable%",oninput:"%oninput_summary%",onblur:"%onblur_summary%"}}},{id:"footer",inner:[{id:"priority",class:"entry",inner:{class:"value",inner:"%priority%",contenteditable:"%editable%",onfocus:"%onfocus_priority%"}},{id:"deadline",class:"entry",inner:[{class:"value",inner:"%deadline%",contenteditable:"%editable%",onfocus:"%onfocus_deadline%"},{inner:{tag:"img",src:"%icon_deadline%"}}]}]}]},css:["ccm.load","https://ccmjs.github.io/akless-components/kanban_card/resources/default.css"],data:{},editable:true,members:["John","Jane"],priorities:["A","B","C"],icon:{owner:"https://ccmjs.github.io/akless-components/kanban_card/resources/owner.svg",deadline:"https://ccmjs.github.io/akless-components/kanban_card/resources/deadline.svg"}},Instance:function(){let $,data;this.init=(async()=>{$=this.ccm.helper;if($.isObject(this.data)&&$.isDatastore(this.data.store))this.data.store.onchange=this.start});this.ready=(async()=>{this.logger&&this.logger.log("ready",$.privatize(this,true))});this.start=(async()=>{data=await $.dataset(this.data);this.logger&&this.logger.log("start",$.clone(data));$.setContent(this.element,$.html(this.html,$.integrate({title:"",owner:"",summary:"",priority:"",deadline:"",icon_owner:this.icon.owner,icon_deadline:this.icon.deadline,editable:!!this.editable,oninput_title:function(){update("title",this.innerText.replace(/\n/g,""))},onblur_title:function(){this.innerHTML=data.title||""},onfocus_owner:function(){select(this,true)},oninput_summary:function(){update("summary",this.innerText.replace(/\n/g,""))},onblur_summary:function(){this.innerHTML=data.summary||""},onfocus_priority:function(){select(this,false)},onfocus_deadline:function(){input(this)}},data,true)));const self=this;async function update(prop,value){self.user&&await self.user.login();data[prop]=value.trim();$.isObject(self.data)&&$.isDatastore(self.data.store)&&await self.data.store.set(data);self.logger&&self.logger.log("change",{prop:prop,value:value});self.onchange&&self.onchange.call(self,{prop:prop,value:value})}function select(elem,owner_or_prio){const entries=[{tag:"option"}];self[owner_or_prio?"members":"priorities"].forEach(entry=>entries.push({tag:"option",inner:entry,selected:entry===data[owner_or_prio?"owner":"priority"]||""}));$.replace($.html({tag:"select",inner:entries,onchange:onChange,onblur:function(){restore.call(this,elem)}}),elem);self.element.querySelector("select").focus();function onChange(){elem.innerHTML=this.value;update(owner_or_prio?"owner":"priority",this.value)}}function input(elem){$.replace($.html({tag:"input",type:"date",value:data.deadline||"",oninput:onInput,onblur:function(){restore.call(this,elem)}}),elem);self.element.querySelector("input").focus();function onInput(){elem.innerHTML=this.value;update("deadline",this.value)}}function restore(elem){$.replace(elem,this)}});this.getValue=(()=>data)}};let b="ccm."+component.name+(component.version?"-"+component.version.join("."):"")+".js";if(window.ccm&&null===window.ccm.files[b])return window.ccm.files[b]=component;(b=window.ccm&&window.ccm.components[component.name])&&b.ccm&&(component.ccm=b.ccm);"string"===typeof component.ccm&&(component.ccm={url:component.ccm});let c=(component.ccm.url.match(/(0|[1-9]\d*)\.(0|[1-9]\d*)\.(0|[1-9]\d*)/)||["latest"])[0];if(window.ccm&&window.ccm[c])window.ccm[c].component(component);else{var a=document.createElement("script");document.head.appendChild(a);component.ccm.integrity&&a.setAttribute("integrity",component.ccm.integrity);component.ccm.crossorigin&&a.setAttribute("crossorigin",component.ccm.crossorigin);a.onload=function(){window.ccm[c].component(component);document.head.removeChild(a)};a.src=component.ccm.url}})();