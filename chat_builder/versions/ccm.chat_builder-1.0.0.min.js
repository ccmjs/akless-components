(()=>{const component={name:"chat_builder",version:[1,0,0],ccm:"https://ccmjs.github.io/ccm/versions/ccm-26.1.1.js",config:{css:["ccm.load",["https://ccmjs.github.io/akless-components/libs/bootstrap-4/css/bootstrap.min.css","https://ccmjs.github.io/akless-components/chat_builder/resources/default.css"]],helper:["ccm.load","https://ccmjs.github.io/akless-components/modules/versions/helper-6.0.1.mjs"],html:["ccm.load","https://ccmjs.github.io/akless-components/chat_builder/resources/templates.mjs"],ignore:{css:{snack:{key:"snack",title:"Snack",value:["ccm.load","https://ccmjs.github.io/akless-components/chat/resources/snack.css"]}},defaults:{data:{store:["ccm.store",{name:"chat-data",url:"https://ccm2.inf.h-brs.de"}]},editor:["ccm.start","https://ccmjs.github.io/tkless-components/editor/versions/ccm.editor-4.0.0.js",{editor:["ccm.load","https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/highlight.min.js","https://ccmjs.github.io/tkless-components/libs/quill/quill.js","https://cdn.quilljs.com/1.2.0/quill.snow.css"],settings:{modules:{toolbar:[["bold","italic","strike","link"]]},placeholder:"",theme:"snow"}}],hide_lang:true,lang:["ccm.instance","https://ccmjs.github.io/tkless-components/lang/versions/ccm.lang-1.0.0.js",{translations:{de:{flag:"https://ccmjs.github.io/tkless-components/lang/resources/de.svg",send:"Senden"},en:{flag:"https://ccmjs.github.io/tkless-components/lang/resources/en.svg",send:"Send"}},active:"en"}]},user:{guest:{key:"guest",title:"Guest Mode",value:["ccm.instance","https://ccmjs.github.io/akless-components/user/versions/ccm.user-9.7.0.js",["ccm.get","https://ccmjs.github.io/akless-components/user/resources/resources.js","guest"]]},cloud:{key:"cloud",title:"Digital Makerspace Account",value:["ccm.instance","https://ccmjs.github.io/akless-components/user/versions/ccm.user-9.7.0.js",["ccm.get","https://ccmjs.github.io/akless-components/user/resources/resources.js","cloud"]]},hbrsinfkaul:{key:"hbrsinfkaul",title:"H-BRS FB02 Account",value:["ccm.instance","https://ccmjs.github.io/akless-components/user/versions/ccm.user-9.7.0.js",["ccm.get","https://ccmjs.github.io/akless-components/user/resources/resources.js","hbrsinfkaul"]]},hbrsinfpseudo:{key:"hbrsinfpseudo",title:"H-BRS FB02 Account with Pseudonym",value:["ccm.instance","https://ccmjs.github.io/akless-components/user/versions/ccm.user-9.7.0.js",["ccm.get","https://ccmjs.github.io/akless-components/user/resources/resources.js","hbrsinfpseudo"]]},pseudo:{key:"pseudo",title:"One-time Pseudonym",value:["ccm.instance","https://ccmjs.github.io/akless-components/user/versions/ccm.user-9.7.0.js",["ccm.get","https://ccmjs.github.io/akless-components/user/resources/resources.js","pseudo"]]}}},libs:["ccm.load",["https://ccmjs.github.io/akless-components/libs/jquery-3/jquery.min.js","https://ccmjs.github.io/akless-components/libs/bootstrap-4/js/bootstrap.bundle.min.js"]],preview:"Preview",shadow:"none",submit:"Submit",tool:["ccm.component","https://ccmjs.github.io/akless-components/chat/versions/ccm.chat-2.0.0.js"]},Instance:function(){let $,chat_config;this.ready=(async()=>{$=Object.assign({},this.ccm.helper,this.helper);$.use(this.ccm);delete this.tool.config.parent;this.logger&&this.logger.log("ready",$.privatize(this,true))});this.start=(async()=>{chat_config=await $.dataset(this.data);if(!chat_config.data)chat_config["data.key"]=$.generateKey();chat_config=await $.integrate(chat_config,await $.integrate(this.ignore.defaults,this.tool.config));this.logger&&this.logger.log("start",$.clone(chat_config));this.render(chat_config);jQuery("[data-toggle=popover]").popover();this.element.querySelectorAll("*[name]").forEach(input=>input.addEventListener("change",()=>this.render()));jQuery("#cb-preview").on("show.bs.modal",()=>this.tool.start(Object.assign(this.getValue(),{root:this.element.querySelector("#cb-preview-body")})));this.submit&&this.element.querySelector("form").addEventListener("submit",event=>{event.preventDefault();const result_data=this.getValue();this.logger&&this.logger.log("finish",$.clone(result_data));$.onFinish(this,result_data)})});this.render=((config=this.getValue())=>{$.render($.html(this.html.main,config,this),this.element)});this.getValue=(()=>{const config=Object.assign(chat_config,$.formData(this.element));if(config.user)config.user=this.ignore.user[config.user].value;config.editor[2].settings.modules.toolbar=[[]];for(const key in config.toolbar)if(config.toolbar[key])config.editor[2].settings.modules.toolbar[0].push(key);delete config.toolbar;config.hide_lang=config.language!=="lang";config.lang[2].active=config.language!=="lang"?config.language:"en";delete config.language;return config})}};let b="ccm."+component.name+(component.version?"-"+component.version.join("."):"")+".js";if(window.ccm&&null===window.ccm.files[b])return window.ccm.files[b]=component;(b=window.ccm&&window.ccm.components[component.name])&&b.ccm&&(component.ccm=b.ccm);"string"===typeof component.ccm&&(component.ccm={url:component.ccm});let c=(component.ccm.url.match(/(0|[1-9]\d*)\.(0|[1-9]\d*)\.(0|[1-9]\d*)/)||[""])[0];if(window.ccm&&window.ccm[c])window.ccm[c].component(component);else{var a=document.createElement("script");document.head.appendChild(a);component.ccm.integrity&&a.setAttribute("integrity",component.ccm.integrity);component.ccm.crossorigin&&a.setAttribute("crossorigin",component.ccm.crossorigin);a.onload=function(){(c="latest"?window.ccm:window.ccm[c]).component(component);document.head.removeChild(a)};a.src=component.ccm.url}})();