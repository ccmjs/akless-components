(()=>{const component={name:"team_project",version:[2,0,0],ccm:"https://ccmjs.github.io/ccm/versions/ccm-26.1.1.js",config:{chat:["ccm.component","https://ccmjs.github.io/akless-components/chat/versions/ccm.chat-2.0.0.js"],css:["ccm.load","https://ccmjs.github.io/akless-components/team_project/resources/default.css"],data:{store:["ccm.store"]},entries:["Teams","Kanban Board","Chat"],helper:["ccm.load","https://ccmjs.github.io/akless-components/modules/versions/helper-6.0.1.mjs"],html:["ccm.load","https://ccmjs.github.io/akless-components/team_project/resources/templates.html"],kanban_board:["ccm.component","https://ccmjs.github.io/akless-components/kanban_board/versions/ccm.kanban_board-4.0.0.js"],menu:["ccm.component","https://ccmjs.github.io/akless-components/menu/versions/ccm.menu-3.0.0.js",["ccm.get","https://ccmjs.github.io/akless-components/menu/resources/configs.js","top_tabs"]],teambuild:["ccm.component","https://ccmjs.github.io/akless-components/teambuild/versions/ccm.teambuild-5.0.0.js"]},Instance:function(){let $,chat,kanban_board,main_elem,menu,team_data,team_nr,teambuild;this.init=(async()=>{$=Object.assign({},this.ccm.helper,this.helper);$.use(this.ccm);if(this.user)this.user.onchange=this.start;this.data.store.onchange=null});this.ready=(async()=>{this.logger&&this.logger.log("ready",$.privatize(this,true))});this.start=(async()=>{this.logger&&this.logger.log("start",this.getValue());main_elem=$.html(this.html.main);if(this.user){$.append(main_elem.querySelector("#top"),this.user.root);this.user.start()}teambuild=await this.teambuild.start({data:{store:["ccm.store",Object.assign(this.data.store.source(),{dataset:this.data.key+"-teams"})],key:this.data.key+"-teams"},onchange:async event=>{switch(event.event){case"join":case"leave":team_nr=event.event==="join"?event.nr:0;team_data=teambuild.getTeamData(team_nr);await updateMenu(!team_nr);await updateKanbanBoard();await updateChat();break}},user:this.user?["ccm.instance",this.user.component.url,JSON.parse(this.user.config)]:""});team_nr=teambuild.getUserTeam();team_data=teambuild.getTeamData(team_nr);team_nr&&await updateKanbanBoard();team_nr&&await updateChat();await renderMenu();$.setContent(this.element,main_elem)});const renderMenu=async()=>{menu=await this.menu.start({root:main_elem.querySelector("#menu"),data:{entries:this.entries.map((title,i)=>{return{title:title,disabled:!(!i||team_nr)}})},selected:1,onchange:async event=>{switch(event.id){case 1:$.setContent(main_elem.querySelector("#content"),teambuild.root);break;case 2:$.setContent(main_elem.querySelector("#content"),kanban_board.root);break;case 3:$.setContent(main_elem.querySelector("#content"),chat.root);break}}})};const updateMenu=disable=>{menu.disable(2,disable);menu.disable(3,disable)};const updateKanbanBoard=async()=>{if(!team_nr)return kanban_board=null;kanban_board=await this.kanban_board.start({data:{store:["ccm.store",Object.assign(this.data.store.source(),{dataset:this.data.key+"-board-"+team_data.key})],key:this.data.key+"-team-"+team_data.key+"-kanban"},"ignore.card.config.data.store":["ccm.store",this.data.store.source()],"ignore.card.config.user":["ccm.instance",this.user.component.url,JSON.parse(this.user.config)],members:Object.keys(team_data.members).sort(),user:["ccm.instance",this.user.component.url,JSON.parse(this.user.config)]})};const updateChat=async()=>{if(!team_nr)return chat=null;chat=await this.chat.start({data:{store:["ccm.store",this.data.store.source()],key:this.data.key+"-team-"+team_data.key+"-chat"},user:["ccm.instance",this.user.component.url,JSON.parse(this.user.config)]})}}};let b="ccm."+component.name+(component.version?"-"+component.version.join("."):"")+".js";if(window.ccm&&null===window.ccm.files[b])return window.ccm.files[b]=component;(b=window.ccm&&window.ccm.components[component.name])&&b.ccm&&(component.ccm=b.ccm);"string"===typeof component.ccm&&(component.ccm={url:component.ccm});let c=(component.ccm.url.match(/(0|[1-9]\d*)\.(0|[1-9]\d*)\.(0|[1-9]\d*)/)||[""])[0];if(window.ccm&&window.ccm[c])window.ccm[c].component(component);else{var a=document.createElement("script");document.head.appendChild(a);component.ccm.integrity&&a.setAttribute("integrity",component.ccm.integrity);component.ccm.crossorigin&&a.setAttribute("crossorigin",component.ccm.crossorigin);a.onload=function(){(c="latest"?window.ccm:window.ccm[c]).component(component);document.head.removeChild(a)};a.src=component.ccm.url}})();