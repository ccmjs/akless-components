import{isPrimitive}from"../lib/parts.js";import{directive}from"../lit-html.js";const _state=new WeakMap;const _infinity=2147483647;export const until=directive((...args)=>part=>{let state=_state.get(part);if(state===undefined){state={lastRenderedIndex:_infinity,values:[]};_state.set(part,state)}const previousValues=state.values;let previousLength=previousValues.length;state.values=args;for(let i=0;i<args.length;i++){if(i>state.lastRenderedIndex){break}const value=args[i];if(isPrimitive(value)||typeof value.then!=="function"){part.setValue(value);state.lastRenderedIndex=i;break}if(i<previousLength&&value===previousValues[i]){continue}state.lastRenderedIndex=_infinity;previousLength=0;Promise.resolve(value).then(resolvedValue=>{const index=state.values.indexOf(value);if(index>-1&&index<state.lastRenderedIndex){state.lastRenderedIndex=index;part.setValue(resolvedValue);part.commit()}})}});