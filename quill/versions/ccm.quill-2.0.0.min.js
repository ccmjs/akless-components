(()=>{const component={name:"quill",version:[2,0,0],ccm:"https://ccmjs.github.io/ccm/versions/ccm-27.3.1.min.js",config:{css:["ccm.load",["https://ccmjs.github.io/akless-components/libs/quill-1/quill.snow.min.css","https://ccmjs.github.io/akless-components/quill/resources/styles.css"]],helper:["ccm.load","https://ccmjs.github.io/akless-components/modules/versions/helper-8.1.0.min.mjs"],libs:["ccm.load","https://ccmjs.github.io/akless-components/libs/quill-1/quill.min.js"],options:{theme:"snow",modules:{toolbar:[[{header:[1,2,3,4,5,6,false]}],["bold","italic","underline","strike"],[{color:[]},{background:[]}],[{script:"super"},{script:"sub"}],[{list:"ordered"},{list:"bullet"}],["link","image","video"],["clean"]]}},shadow:"none"},Instance:function(){let $;this.ready=(async()=>{$=Object.assign({},this.ccm.helper,this.helper);$.use(this.ccm);this.quill=new Quill(this.element,this.options);if(this.buttons){const format=$.html({tag:"span",class:"ql-formats"});this.buttons.forEach(button=>{const onclick=button.onclick;button.onclick=(event=>{event.instance=this;onclick(event)});button.tag="button";format.appendChild($.html(button))});this.quill.getModule("toolbar").container.appendChild(format)}if(this.html&&this.embed){const format=$.html({tag:"span",class:"ql-formats"});this.quill.getModule("toolbar").container.appendChild(format);format.appendChild($.html({tag:"button",inner:this.embed.icon,onclick:async()=>{const range=this.quill.getSelection(true);const input=prompt(this.embed.prompt);const app=await $.appDependency(input);if(!app)return;this.quill.insertEmbed(range.index,"embed-app",app,Quill.sources.USER);this.quill.setSelection(range.index+1,Quill.sources.SILENT);startApp(this.quill.root.querySelector("ccm-app:empty"))}}));const BlockEmbed=Quill.import("blots/block/embed");class EmbedContent extends BlockEmbed{static create(app){const node=super.create(app);node.setAttribute("component",app[1]);node.setAttribute("src",JSON.stringify(app[2]));return node}}EmbedContent.blotName="embed-app";EmbedContent.tagName="ccm-app";Quill.register(EmbedContent,true)}});this.start=(async()=>{if(this.data){const data=await $.dataset(this.data);this.html?this.setHTML(data.value):this.quill.setContents(data)}this.quill.root.querySelectorAll("ccm-app").forEach(startApp);this.onchange&&this.quill.on("text-change",()=>this.onchange({instance:this}));this.onstart&&await this.onstart({instance:this})});this.getValue=(()=>this.html?{value:this.getHTML()}:this.quill.getContents());this.getHTML=(()=>this.quill.root.innerHTML);this.setHTML=(html=>this.quill.root.innerHTML=html);const startApp=app=>{$.setContent(app,$.loading());this.ccm.start(app.getAttribute("component"),{root:app,src:JSON.parse(app.getAttribute("src"))})}}};let b="ccm."+component.name+(component.version?"-"+component.version.join("."):"")+".js";if(window.ccm&&null===window.ccm.files[b])return window.ccm.files[b]=component;(b=window.ccm&&window.ccm.components[component.name])&&b.ccm&&(component.ccm=b.ccm);"string"===typeof component.ccm&&(component.ccm={url:component.ccm});let c=(component.ccm.url.match(/(0|[1-9]\d*)\.(0|[1-9]\d*)\.(0|[1-9]\d*)/)||[""])[0];if(window.ccm&&window.ccm[c])window.ccm[c].component(component);else{var a=document.createElement("script");document.head.appendChild(a);component.ccm.integrity&&a.setAttribute("integrity",component.ccm.integrity);component.ccm.crossorigin&&a.setAttribute("crossorigin",component.ccm.crossorigin);a.onload=function(){(c="latest"?window.ccm:window.ccm[c]).component(component);document.head.removeChild(a)};a.src=component.ccm.url}})();